"use strict";(self.webpackChunkimperial=self.webpackChunkimperial||[]).push([[538],{9538:(D,b,s)=>{s.r(b),s.d(b,{ConfigurationModule:()=>ce});var v=s(9562),o=s(5030),x=s(6356),h=s(5861),U=s(512),p=s(3627),Z=s(2611),f=s(2534),C=s(9025),e=s(2223),_=s(6081),T=s(7066),P=s(3144);let q=(()=>{class t extends T.D{constructor(r){var i;super(),i=this,this.http=r,this.loadUsers=function(){var l=(0,h.Z)(function*(m,g=null){return i.http.get(`${i.getApiUrl()}/users?pagination=${JSON.stringify(g)}&type=${m}`,{headers:i.getHeaders()}).toPromise()});return function(m){return l.apply(this,arguments)}}(),this.loadRoles=(0,h.Z)(function*(){return i.http.get(`${i.getApiUrl()}/roles`,{headers:i.getHeaders()}).toPromise()}),this.createUser=function(){var l=(0,h.Z)(function*(m){return i.http.post(`${i.getApiUrl()}/users`,{...m},{headers:i.getHeaders()}).toPromise()});return function(m){return l.apply(this,arguments)}}(),this.updateUser=function(){var l=(0,h.Z)(function*(m,g){return i.http.patch(`${i.getApiUrl()}/users/${m}`,{...g},{headers:i.getHeaders()}).toPromise()});return function(m,g){return l.apply(this,arguments)}}()}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(P.eN))},t.\u0275dir=e.lG2({type:t,features:[e.qOj]}),t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var I=s(9089),R=s(6550),H=s(1576);const J=["searchInput"];function O(t,a){1&t&&(e.TgZ(0,"mat-header-cell",42)(1,"span",43),e._uU(2,"CPF"),e.qZA()())}function Q(t,a){if(1&t&&(e.TgZ(0,"mat-cell",42)(1,"span",44),e._uU(2),e.qZA()()),2&t){const r=a.$implicit;e.xp6(2),e.Oqu(r.cpf)}}function $(t,a){1&t&&(e.TgZ(0,"mat-header-cell",45)(1,"span",43),e._uU(2,"Nombre completo"),e.qZA()())}function G(t,a){if(1&t&&(e.TgZ(0,"mat-cell",45)(1,"span",44),e._uU(2),e.qZA()()),2&t){const r=a.$implicit;e.xp6(2),e.Oqu(r.fullname)}}function z(t,a){1&t&&(e.TgZ(0,"mat-header-cell",46)(1,"span",43),e._uU(2,"Rol"),e.qZA()())}function M(t,a){if(1&t&&(e.TgZ(0,"mat-cell",46)(1,"span",44),e._uU(2),e.qZA()()),2&t){const r=a.$implicit;e.xp6(2),e.Oqu(r.role)}}function B(t,a){1&t&&(e.TgZ(0,"mat-header-cell",45)(1,"span",43),e._uU(2,"E-Mail"),e.qZA()())}function j(t,a){if(1&t&&(e.TgZ(0,"mat-cell",45)(1,"span",44),e._uU(2),e.qZA()()),2&t){const r=a.$implicit;e.xp6(2),e.Oqu(r.email)}}function V(t,a){1&t&&(e.TgZ(0,"mat-header-cell",47)(1,"span",43),e._uU(2,"Direcci\xf3n residencial"),e.qZA()())}function X(t,a){if(1&t&&(e.TgZ(0,"mat-cell",47)(1,"span",44),e._uU(2),e.qZA()()),2&t){const r=a.$implicit;e.xp6(2),e.Oqu(r.residenceAddress)}}function W(t,a){1&t&&(e.TgZ(0,"mat-header-cell",47)(1,"span",43),e._uU(2,"Direcci\xf3n de pago"),e.qZA()())}function K(t,a){if(1&t&&(e.TgZ(0,"mat-cell",47)(1,"span",44),e._uU(2),e.qZA()()),2&t){const r=a.$implicit;e.xp6(2),e.Oqu(r.billingAddress)}}function ee(t,a){1&t&&(e.TgZ(0,"mat-header-cell",45)(1,"span",43),e._uU(2,"Tel\xe9fono"),e.qZA()())}function te(t,a){if(1&t&&(e.TgZ(0,"mat-cell",45)(1,"span",44),e._uU(2),e.qZA()()),2&t){const r=a.$implicit;e.xp6(2),e.Oqu(r.phoneNumber)}}function re(t,a){1&t&&e._UZ(0,"mat-header-row",48)}function ie(t,a){if(1&t){const r=e.EpF();e.TgZ(0,"mat-row",49),e.NdJ("click",function(){const m=e.CHM(r).$implicit,g=e.oxw();return e.KtG(g.editElement(m))}),e.qZA()}}let N=(()=>{class t{constructor(r,i,l,m,g,d){var n=this;this.ngxUiLoaderService=r,this.configService=i,this.dataService=l,this.modalService=m,this.titleService=g,this.router=d,this.filter="client",this.pagination={},this.totalElements=0,this.pageSizeOptions=C.X.pageSizeOptions,this.displayedColumns=["cpf","fullname","phoneNumber","email","residenceAddress","billingAddress"],this.redirect=(c="")=>{this.router.navigate(""!==c?[`${c}`]:[f.f.routes.dash])},this.initPagination=()=>{this.pagination.offset=0,this.pagination.limit=this.defPagination,this.pagination.filter=""},this.dataLoad=(0,h.Z)(function*(){n.ngxUiLoaderService.startLoader("loader-02");try{const c=yield n.configService.loadUsers(n.filter,n.pagination);c.data&&(n.dataSource=new p.by(c.data),n.totalElements=c.count,n.dataSource.sort=n.sort)}catch(c){n.dataService.errorHandling(c)}finally{n.ngxUiLoaderService.stopLoader("loader-02")}}),this.nextPage=c=>{const{pageSize:u,pageIndex:L}=c;this.dataService.setSelectedPagination(u),this.defPagination=this.dataService.getSelectedPagination(),this.pagination.offset=this.defPagination*L,this.pagination.limit=u,this.dataLoad()},this.searchElement=(c=!1)=>{try{this.pagination.filter=this.searchInput.nativeElement.value,c&&(this.paginator&&this.paginator.firstPage(),this.pagination.offset=0,this.dataLoad())}catch(u){this.dataService.errorHandling(u)}},this.getFilter=()=>{switch(this.filter){case"client":return"Clientes";case"worker":return"Trabajadores";default:return""}},this.createElement=()=>{switch(this.filter){case"client":return this.redirect(f.f.routes.clientsCreate);case"worker":return this.redirect(f.f.routes.configUserCreate);default:return""}},this.editElement=c=>{switch(this.dataService.setCreatedUser(c),this.filter){case"client":return this.redirect(f.f.routes.clientsCreate);case"worker":return this.redirect(f.f.routes.configUserCreate);default:return""}},this.filter=this.router.url.includes("workers")?"worker":"client","worker"===this.filter&&(this.displayedColumns=["cpf","fullname","role","phoneNumber","email","residenceAddress"]),this.user=this.dataService.getLoggedUser(),(!this.dataService.getIsLoggedIn()||!this.user)&&(this.dataService.clearLoginData(),this.redirect(f.f.routes.login))}ngOnInit(){this.titleService.setTitle("IMPERIAL | "+this.getFilter()),this.defPagination=this.dataService.getSelectedPagination(),this.initPagination(),this.dataLoad()}openModal(r){this.modalService.open(r,{centered:!0}).result.then(()=>{}).catch(i=>{})}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(_.LA),e.Y36(q),e.Y36(T.D),e.Y36(I.FF),e.Y36(R.Dx),e.Y36(v.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-list"]],viewQuery:function(r,i){if(1&r&&(e.Gf(U.NW,7),e.Gf(Z.YE,7),e.Gf(J,5)),2&r){let l;e.iGM(l=e.CRH())&&(i.paginator=l.first),e.iGM(l=e.CRH())&&(i.sort=l.first),e.iGM(l=e.CRH())&&(i.searchInput=l.first)}},decls:55,vars:9,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"d-flex","align-items-center","flex-wrap","text-nowrap"],[1,"input-group","me-2","mb-2"],["name","searchInput","placeholder","Buscar",1,"form-control","border-primary","bg-transparent",2,"border-top-left-radius","1rem !important","border-bottom-left-radius","1rem !important","margin-left","0.5em","margin-right","0.5em"],["searchInput",""],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"feather","icon-search"],["type","button",1,"btn","btn-green","btn-icon",2,"margin-left","10px",3,"click"],[1,"feather","icon-user-plus"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"card-title"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","cpf"],["fxFlex","auto 1 150px",4,"matHeaderCellDef"],["fxFlex","auto 1 150px",4,"matCellDef"],["matColumnDef","fullname"],["fxFlex","auto 1 200px",4,"matHeaderCellDef"],["fxFlex","auto 1 200px",4,"matCellDef"],["matColumnDef","role"],["fxFlex","auto 1 100px",4,"matHeaderCellDef"],["fxFlex","auto 1 100px",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","residenceAddress"],["fxFlex","auto 1 300px",4,"matHeaderCellDef"],["fxFlex","auto 1 300px",4,"matCellDef"],["matColumnDef","billingAddress"],["matColumnDef","phoneNumber"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",3,"click",4,"matRowDef","matRowDefColumns"],[3,"length","pageSizeOptions","pageSize","page"],["paginator",""],["fxFlex","auto 1 150px"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","padding-left","10px","width","100%"],["fxFlex","auto 1 200px"],["fxFlex","auto 1 100px"],["fxFlex","auto 1 300px"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user",3,"click"]],template:function(r,i){1&r&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Configuraci\xf3n"),e.qZA(),e.TgZ(7,"li",2),e._uU(8),e.qZA(),e.TgZ(9,"li",5),e._uU(10,"Listar"),e.qZA()()(),e.TgZ(11,"div",6)(12,"div",7)(13,"div",8),e._UZ(14,"input",9,10),e.TgZ(16,"button",11),e.NdJ("click",function(){return i.searchElement(!0)}),e._UZ(17,"span",12),e.qZA(),e.TgZ(18,"button",13),e.NdJ("click",function(){return i.createElement()}),e._UZ(19,"span",14),e.qZA()()()(),e.TgZ(20,"div",6)(21,"div",15)(22,"div",16)(23,"div",17)(24,"h6",18),e._uU(25),e.qZA(),e.TgZ(26,"div",19)(27,"div",20)(28,"mat-table",21,22),e.ynx(30,23),e.YNc(31,O,3,0,"mat-header-cell",24),e.YNc(32,Q,3,1,"mat-cell",25),e.BQk(),e.ynx(33,26),e.YNc(34,$,3,0,"mat-header-cell",27),e.YNc(35,G,3,1,"mat-cell",28),e.BQk(),e.ynx(36,29),e.YNc(37,z,3,0,"mat-header-cell",30),e.YNc(38,M,3,1,"mat-cell",31),e.BQk(),e.ynx(39,32),e.YNc(40,B,3,0,"mat-header-cell",27),e.YNc(41,j,3,1,"mat-cell",28),e.BQk(),e.ynx(42,33),e.YNc(43,V,3,0,"mat-header-cell",34),e.YNc(44,X,3,1,"mat-cell",35),e.BQk(),e.ynx(45,36),e.YNc(46,W,3,0,"mat-header-cell",34),e.YNc(47,K,3,1,"mat-cell",35),e.BQk(),e.ynx(48,37),e.YNc(49,ee,3,0,"mat-header-cell",27),e.YNc(50,te,3,1,"mat-cell",28),e.BQk(),e.YNc(51,re,1,0,"mat-header-row",38),e.YNc(52,ie,1,0,"mat-row",39),e.qZA()()(),e.TgZ(53,"mat-paginator",40,41),e.NdJ("page",function(m){return i.nextPage(m)}),e.qZA()()()()()),2&r&&(e.xp6(8),e.Oqu(i.getFilter()),e.xp6(17),e.hij("Lista de ",i.getFilter(),""),e.xp6(3),e.Q6J("dataSource",i.dataSource),e.xp6(23),e.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumns),e.xp6(1),e.Q6J("length",i.totalElements)("pageSizeOptions",i.pageSizeOptions)("pageSize",i.defPagination))},dependencies:[v.rH,Z.YE,U.NW,p.BZ,p.fO,p.as,p.w1,p.Dz,p.nj,p.ge,p.ev,p.XQ,p.Gk,H.yH]}),t})();var ae=s(5170),F=s(4755);function ne(t,a){if(1&t&&(e.TgZ(0,"option",36),e._uU(1),e.qZA()),2&t){const r=a.$implicit;e.s9C("value",r.value),e.xp6(1),e.Oqu(r.name)}}function oe(t,a){if(1&t&&(e.TgZ(0,"div")(1,"div",13)(2,"label",31),e._uU(3,"Rol"),e.qZA(),e.TgZ(4,"select",32),e.YNc(5,ne,2,2,"option",33),e.qZA()(),e.TgZ(6,"div",13)(7,"label",34),e._uU(8,"CPF"),e.qZA(),e._UZ(9,"input",35),e.qZA()()),2&t){const r=e.oxw();e.xp6(5),e.Q6J("ngForOf",r.roles)}}function se(t,a){if(1&t&&(e.TgZ(0,"div")(1,"div",13)(2,"span")(3,"b"),e._uU(4,"Rol:"),e.qZA(),e._uU(5),e.qZA(),e._UZ(6,"br"),e.TgZ(7,"span")(8,"b"),e._uU(9,"CPF:"),e.qZA(),e._uU(10),e.qZA(),e._UZ(11,"br"),e.qZA()()),2&t){const r=e.oxw();e.xp6(5),e.hij(" ",r.getRoleName(r.elementForm.getRawValue().role),""),e.xp6(5),e.hij(" ",r.elementForm.getRawValue().cpf,"")}}const le=[{path:"",redirectTo:"clients",pathMatch:"full"},{path:"workers",component:N},{path:"workers/create",component:(()=>{class t{constructor(r,i,l,m,g){var d=this;this.ngxUiLoaderService=r,this.configService=i,this.dataService=l,this.formBuilder=m,this.router=g,this.roles=[],this.userToEdit=null,this.type="create",this.createForm=()=>this.formBuilder.group({role:["",o.kI.required],cpf:["",o.kI.required],name:["",o.kI.required],lastname:["",o.kI.required],gender:["",o.kI.required],residence:["",o.kI.required],phone:["",o.kI.required],email:["",o.kI.pattern("^[a-z0-9._%+-]+@[a-z0-9.-]+.[a-z]{2,4}$")]}),this.patchForm=()=>{this.elementForm.patchValue({role:this.userToEdit?this.userToEdit.role:"",cpf:this.userToEdit?this.userToEdit.cpf:"",name:this.userToEdit?this.userToEdit.firstName:"",lastname:this.userToEdit?this.userToEdit.paternalSurname:"",gender:this.userToEdit?this.userToEdit.gender:"",residence:this.userToEdit?this.userToEdit.residenceAddress:"",phone:this.userToEdit?this.userToEdit.phoneNumber:"",email:this.userToEdit?this.userToEdit.email:"trabajador@imperial.pronto"}),this.userToEdit&&(this.elementForm.controls.role.disable(),this.elementForm.controls.cpf.disable())},this.redirect=(n="")=>{this.router.navigate(""!==n?[`${n}`]:[f.f.routes.dash])},this.dataLoad=(0,h.Z)(function*(){d.ngxUiLoaderService.startLoader("loader-02");try{const n=yield d.configService.loadRoles();n&&n.length&&(d.roles=n.map(c=>{let u="";switch(c.name){case"collector":u="Cobrador";break;case"admin":u="Administrador";break;default:u="undefined"}return{name:u,value:c.name}})),d.patchForm()}catch(n){d.dataService.errorHandling(n)}finally{d.ngxUiLoaderService.stopLoader("loader-02")}}),this.createClient=function(){var n=(0,h.Z)(function*(c){try{c.preventDefault();const u=d.elementForm.getRawValue(),{role:L,cpf:me,name:w,lastname:E,gender:k,residence:A,phone:Y,email:y}=u;if(y.length&&!ae.G.isValidEmail(y))return void d.dataService.errorHandling({front:!0,message:"La direcci\xf3n de correo no es v\xe1lida, verifique e intente nuevamente."});if(d.userToEdit){const S={email:y,firstName:w.toLowerCase(),paternalSurname:E.toLowerCase(),residenceAddress:A,billingAddress:A,phoneNumber:Y,profilePicture:"",addressPicture:"",gender:k};yield d.configService.updateUser(d.userToEdit.id,S)}else{const S={role:L,cpf:me.toLowerCase().trim(),email:y,firstName:w.toLowerCase(),paternalSurname:E.toLowerCase(),residenceAddress:A,billingAddress:A,phoneNumber:Y,profilePicture:"",addressPicture:"",gender:k};yield d.configService.createUser(S)}d.dataService.clearCreatedUser(),d.redirect(f.f.routes.configWorkers)}catch(u){d.dataService.errorHandling(u)}});return function(c){return n.apply(this,arguments)}}(),this.getRoleName=n=>{switch(n){case"collector":return"Cobrador";case"admin":return"Administrador";default:return"undefined"}}}ngOnInit(){this.userToEdit=this.dataService.getCreatedUser()??null,this.userToEdit&&(this.type="edit"),this.elementForm=this.createForm(),this.dataLoad()}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(_.LA),e.Y36(q),e.Y36(T.D),e.Y36(o.qu),e.Y36(v.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create"]],decls:53,vars:5,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dash"],[1,"feather","icon-home"],["routerLink","/admin/configuration/workers"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],["name","elementForm","novalidate","",3,"formGroup"],[4,"ngIf"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","formControlName","name","autocomplete","off","required","",1,"form-control"],["for","lastname",1,"form-label"],["type","text","id","lastname","formControlName","lastname","autocomplete","off","required","",1,"form-control"],["for","gender",1,"form-label"],["id","gender","formControlName","gender","required","",1,"form-select"],["value","male","selected",""],["value","female"],["for","residence",1,"form-label"],["type","text","id","residence","formControlName","residence","autocomplete","off","required","",1,"form-control"],["for","phone",1,"form-label"],["type","text","id","phone","appInputRestriction","int","oninput","this.value=this.value.replace(/[^0-9]/g,'')","formControlName","phone","autocomplete","off","required","",1,"form-control"],["for","email",1,"form-label"],["type","text","id","email","formControlName","email","autocomplete","off",1,"form-control"],[2,"text-align","center"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled","click"],[1,"btn","btn-secondary",3,"routerLink","click"],["for","role",1,"form-label"],["id","role","formControlName","role","required","",1,"form-select"],["selected","",3,"value",4,"ngFor","ngForOf"],["for","cpf",1,"form-label"],["type","text","id","cpf","appInputRestriction","int","oninput","this.value=this.value.replace(/[^0-9]/g,'')","formControlName","cpf","autocomplete","off","required","",1,"form-control"],["selected","",3,"value"]],template:function(r,i){1&r&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Configuraci\xf3n"),e.qZA(),e.TgZ(7,"li",2)(8,"a",5),e._uU(9,"Trabajadores"),e.qZA()(),e.TgZ(10,"li",6),e._uU(11,"Registrar trabajador"),e.qZA()()(),e.TgZ(12,"div",7)(13,"div",8)(14,"div",9)(15,"div",10)(16,"form",11),e.YNc(17,oe,10,1,"div",12),e.YNc(18,se,12,2,"div",12),e.TgZ(19,"div",13)(20,"label",14),e._uU(21,"Nombre"),e.qZA(),e._UZ(22,"input",15),e.qZA(),e.TgZ(23,"div",13)(24,"label",16),e._uU(25,"Apellido"),e.qZA(),e._UZ(26,"input",17),e.qZA(),e.TgZ(27,"div",13)(28,"label",18),e._uU(29,"Sexo"),e.qZA(),e.TgZ(30,"select",19)(31,"option",20),e._uU(32,"Hombre"),e.qZA(),e.TgZ(33,"option",21),e._uU(34,"Mujer"),e.qZA()()(),e.TgZ(35,"div",13)(36,"label",22),e._uU(37,"Direcci\xf3n residencial"),e.qZA(),e._UZ(38,"input",23),e.qZA(),e.TgZ(39,"div",13)(40,"label",24),e._uU(41,"N\xfamero de tel\xe9fono"),e.qZA(),e._UZ(42,"input",25),e.qZA(),e.TgZ(43,"div",13)(44,"label",26),e._uU(45,"E-Mail"),e.qZA(),e._UZ(46,"input",27),e.qZA(),e._UZ(47,"hr"),e.TgZ(48,"div",28)(49,"button",29),e.NdJ("click",function(m){return i.createClient(m)}),e._uU(50,"Aceptar"),e.qZA(),e.TgZ(51,"button",30),e.NdJ("click",function(){return!1}),e._uU(52,"Cancelar"),e.qZA()()()()()()()),2&r&&(e.xp6(16),e.Q6J("formGroup",i.elementForm),e.xp6(1),e.Q6J("ngIf","create"===i.type),e.xp6(1),e.Q6J("ngIf","edit"===i.type),e.xp6(31),e.Q6J("disabled",i.elementForm.invalid),e.xp6(2),e.Q6J("routerLink","/admin/configuration/workers"))},dependencies:[v.rH,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.Q7,F.sg,F.O5,o.sg,o.u]}),t})()},{path:"clients",component:N}];let ce=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[v.Bz.forChild(le),o.u5,x.A,o.UX]}),t})()},5861:(D,b,s)=>{function v(x,h,U,p,Z,f,C){try{var e=x[f](C),_=e.value}catch(T){return void U(T)}e.done?h(_):Promise.resolve(_).then(p,Z)}function o(x){return function(){var h=this,U=arguments;return new Promise(function(p,Z){var f=x.apply(h,U);function C(_){v(f,p,Z,C,e,"next",_)}function e(_){v(f,p,Z,C,e,"throw",_)}C(void 0)})}}s.d(b,{Z:()=>o})}}]);