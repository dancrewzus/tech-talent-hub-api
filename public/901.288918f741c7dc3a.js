"use strict";(self.webpackChunkimperial=self.webpackChunkimperial||[]).push([[901],{4901:(xt,k,p)=>{p.r(k),p.d(k,{MovementsModule:()=>pt});var y=p(9562),s=p(5030),f=p(5861),x=p(4755),S=p(7228),H=p(5226),C=p.n(H),Z=p(2534),d=p(3627),e=p(2223),D=p(6081),T=p(7066),Q=p(3144);let w=(()=>{class t extends T.D{constructor(n){var o;super(),o=this,this.http=n,this.createMovement=function(){var c=(0,f.Z)(function*(l){return o.http.post(`${o.getApiUrl()}/movements`,{...l},{headers:o.getHeaders()}).toPromise()});return function(l){return c.apply(this,arguments)}}(),this.updateUser=function(){var c=(0,f.Z)(function*(l,_){return o.http.patch(`${o.getApiUrl()}/movements/${l}`,{..._},{headers:o.getHeaders()}).toPromise()});return function(l,_){return c.apply(this,arguments)}}(),this.dailyResume=function(){var c=(0,f.Z)(function*(l){return o.http.get(`${o.getApiUrl()}/movements/daily-resume/${l}`,{headers:o.getHeaders()}).toPromise()});return function(l){return c.apply(this,arguments)}}(),this.deleteComment=function(){var c=(0,f.Z)(function*(l){return o.http.get(`${o.getApiUrl()}/movements/delete-comment/${l}`,{headers:o.getHeaders()}).toPromise()});return function(l){return c.apply(this,arguments)}}(),this.movementsPending=(0,f.Z)(function*(){return o.http.get(`${o.getApiUrl()}/movements/pending`,{headers:o.getHeaders()}).toPromise()}),this.validateMovement=function(){var c=(0,f.Z)(function*(l){return o.http.post(`${o.getApiUrl()}/movements/validate-movement`,l,{headers:o.getHeaders()}).toPromise()});return function(l){return c.apply(this,arguments)}}(),this.cancelMovement=function(){var c=(0,f.Z)(function*(l){return o.http.post(`${o.getApiUrl()}/movements/cancel-movement`,{id:l},{headers:o.getHeaders()}).toPromise()});return function(l){return c.apply(this,arguments)}}(),this.movementsFromToday=function(){var c=(0,f.Z)(function*(l){return o.http.get(`${o.getApiUrl()}/movements/from-today/${l}`,{headers:o.getHeaders()}).toPromise()});return function(l){return c.apply(this,arguments)}}()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(Q.eN))},t.\u0275dir=e.lG2({type:t,features:[e.qOj]}),t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var q=p(6550),M=p(2611),R=p(1576),L=p(9089);function $(t,a){1&t&&(e.TgZ(0,"mat-header-cell",34)(1,"span",35),e._uU(2,"Descripci\xf3n"),e.qZA()())}function E(t,a){if(1&t&&(e.TgZ(0,"mat-cell",34)(1,"span",36),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.description)}}function V(t,a){1&t&&(e.TgZ(0,"mat-header-cell",37)(1,"span",35),e._uU(2,"Ingresos"),e.qZA()())}function j(t,a){if(1&t&&(e.TgZ(0,"mat-cell",37)(1,"span",38),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.amount,"","es")," R$")}}function O(t,a){1&t&&(e.TgZ(0,"mat-header-cell",39)(1,"span",35),e._uU(2,"Imagen"),e.qZA()())}function G(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"span",35)(1,"button",41),e.NdJ("click",function(){e.CHM(n);const c=e.oxw().$implicit,l=e.oxw();return e.KtG(l.openImage(c.paymentPicture))}),e._UZ(2,"span",42),e.qZA()()}}function K(t,a){1&t&&e._UZ(0,"span",35)}function W(t,a){if(1&t&&(e.TgZ(0,"mat-cell",39),e.YNc(1,G,3,0,"span",40),e.YNc(2,K,1,0,"span",40),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Q6J("ngIf",n.paymentPicture),e.xp6(1),e.Q6J("ngIf",!n.paymentPicture)}}function z(t,a){1&t&&(e.TgZ(0,"mat-header-cell",43)(1,"span",35),e._uU(2,"Opciones"),e.qZA()())}function X(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"mat-cell",43)(1,"div",44)(2,"button",45),e.NdJ("click",function(){const l=e.CHM(n).$implicit,_=e.oxw();return e.KtG(_.validatePayment(l,"validate"))}),e._UZ(3,"span",46),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){const l=e.CHM(n).$implicit,_=e.oxw();return e.KtG(_.validatePayment(l,"cancel"))}),e._UZ(5,"span",48),e.qZA(),e.TgZ(6,"button",49),e.NdJ("click",function(){const l=e.CHM(n).index,_=e.oxw();return e.KtG(_.editPayment(l))}),e._UZ(7,"span",50),e.qZA()()()}}function ee(t,a){1&t&&e._UZ(0,"mat-header-row",51)}function te(t,a){1&t&&e._UZ(0,"mat-row",52)}let ne=(()=>{class t{constructor(n,o,c,l,_){var v=this;this.ngxUiLoaderService=n,this.movementsService=o,this.dataService=c,this.titleService=l,this.router=_,this.yesterdayAmount=0,this.todayAmount=0,this.movementsFromToday=[],this.closed=!1,this.displayedColumns=["details","amount","image","options"],this.redirect=(r="")=>{this.router.navigate(""!==r?[`${r}`]:[Z.f.routes.dash])},this.loadData=(0,f.Z)(function*(){v.ngxUiLoaderService.startLoader("loader-02");try{const r=yield v.movementsService.movementsPending();if(r){const{data:m,todayAmount:i}=r;v.todayAmount=i,v.dataSource=new d.by(m)}}catch(r){v.dataService.errorHandling(r)}finally{v.ngxUiLoaderService.stopLoader("loader-02")}}),this.validatePayment=function(){var r=(0,f.Z)(function*(m,i){C().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"validate"===i?"Validar":"Anular",cancelButtonText:"Cancelar"}).then(u=>{u.isConfirmed&&v.sendPayment(m,i)})});return function(m,i){return r.apply(this,arguments)}}(),this.sendPayment=function(){var r=(0,f.Z)(function*(m,i){try{switch(v.ngxUiLoaderService.startLoader("loader-02"),i){case"validate":yield v.movementsService.validateMovement({id:m.id,amount:m.amount});break;case"cancel":yield v.movementsService.cancelMovement(m.id)}window.location.reload()}catch(u){v.dataService.errorHandling(u)}finally{v.ngxUiLoaderService.stopLoader("loader-02")}});return function(m,i){return r.apply(this,arguments)}}(),this.editPayment=function(){var r=(0,f.Z)(function*(m){const i=v.dataSource.data[m],{value:u}=yield C().fire({imageUrl:i.paymentPicture,title:"Editar pago reportado",input:"number",inputLabel:"Ingresa el nuevo monto",showCancelButton:!0,confirmButtonText:"Editar",cancelButtonText:"Cerrar",inputAttributes:{style:"color: white; text-align: right;"}});i.amount=u,v.dataSource.data[m]=i});return function(m){return r.apply(this,arguments)}}(),this.openImage=r=>{C().fire({title:"<strong>Imagen</strong>",html:`<div class="card"><div class="card-body"><img src="${r}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Cerrar",confirmButtonAriaLabel:"close"})},this.user=this.dataService.getLoggedUser(),(!this.dataService.getIsLoggedIn()||!this.user)&&(this.dataService.clearLoginData(),this.redirect(Z.f.routes.login))}ngOnInit(){(0,x.qS)(S.Z),this.titleService.setTitle("IMPERIAL | Pagos pendientes por validar"),this.loadData()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(D.LA),e.Y36(w),e.Y36(T.D),e.Y36(q.Dx),e.Y36(y.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-payments-pending"]],decls:44,vars:9,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"card-title"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","details"],["fxFlex","auto 1 200px",4,"matHeaderCellDef"],["fxFlex","auto 1 200px",4,"matCellDef"],["matColumnDef","amount"],["fxFlex","auto 1",4,"matHeaderCellDef"],["fxFlex","auto 1",4,"matCellDef"],["matColumnDef","image"],["fxFlex","auto 1 100px",4,"matHeaderCellDef"],["fxFlex","auto 1 100px",4,"matCellDef"],["matColumnDef","options"],["fxFlex","auto 1 170px",4,"matHeaderCellDef"],["fxFlex","auto 1 170px",4,"matCellDef"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",4,"matRowDef","matRowDefColumns"],[1,"mb-3"],["for","paymentAmount",1,"form-label"],[1,"input-group"],["placement","bottom","ngbTooltip","Tooltip on bottom",1,"input-group-text","hover"],["disabled","","type","number","id","paymentAmount","autocomplete","off","required","",1,"form-control",2,"text-align","right",3,"value"],["fxFlex","auto 1 200px"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","width","100%"],["fxFlex","auto 1"],[2,"margin","0","text-align","right","width","100%"],["fxFlex","auto 1 100px"],["style","margin: 0; text-align: center; width: 100%;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"feather","icon-image"],["fxFlex","auto 1 170px"],["role","group",1,"btn-group",2,"margin","0","text-align","center","width","100%"],["type","button",1,"btn","btn-green",3,"click"],[1,"feather","icon-check"],["type","button",1,"btn","btn-red",2,"margin","0 6px",3,"click"],[1,"feather","icon-x"],["type","button",1,"btn","btn-primary",3,"click"],[1,"feather","icon-edit-2"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user"]],template:function(n,o){1&n&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimientos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Pagos pendientes por validar"),e.qZA()()(),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"h6",10),e._uU(14,"Pagos pendientes por validar"),e.qZA(),e.TgZ(15,"div",11)(16,"div",12)(17,"mat-table",13,14),e.ynx(19,15),e.YNc(20,$,3,0,"mat-header-cell",16),e.YNc(21,E,3,1,"mat-cell",17),e.BQk(),e.ynx(22,18),e.YNc(23,V,3,0,"mat-header-cell",19),e.YNc(24,j,4,5,"mat-cell",20),e.BQk(),e.ynx(25,21),e.YNc(26,O,3,0,"mat-header-cell",22),e.YNc(27,W,3,2,"mat-cell",23),e.BQk(),e.ynx(28,24),e.YNc(29,z,3,0,"mat-header-cell",25),e.YNc(30,X,8,0,"mat-cell",26),e.BQk(),e.YNc(31,ee,1,0,"mat-header-row",27),e.YNc(32,te,1,0,"mat-row",28),e.qZA()()(),e._UZ(33,"br")(34,"br"),e.TgZ(35,"div",29)(36,"label",30)(37,"b"),e._uU(38,"Monto pendiente por validar"),e.qZA()(),e.TgZ(39,"div",31)(40,"span",32),e._uU(41,"R$"),e.qZA(),e._UZ(42,"input",33),e.ALo(43,"number"),e.qZA()()()()()()),2&n&&(e.xp6(17),e.Q6J("dataSource",o.dataSource),e.xp6(14),e.Q6J("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(10),e.s9C("value",e.Dn7(43,5,o.todayAmount,"","es")))},dependencies:[y.rH,x.O5,M.YE,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,R.yH,L._L,x.JJ],styles:[".ngx-datatable[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]{display:none!important}"]}),t})();var ae=p(274),oe=p(1545),ie=p(5268),A=p(1764);function re(t,a){if(1&t&&(e.TgZ(0,"option",38),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.s9C("value",n.id),e.xp6(1),e.Oqu(n.fullname)}}function le(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div"),e._UZ(1,"hr"),e.TgZ(2,"div",31)(3,"label",34),e._uU(4,"Seleccione trabajador"),e.qZA(),e.TgZ(5,"select",35),e.NdJ("change",function(c){e.CHM(n);const l=e.oxw();return e.KtG(l.changeWorker(c))}),e.TgZ(6,"option",36),e._uU(7,"General"),e.qZA(),e.YNc(8,re,2,2,"option",37),e.qZA()()()}if(2&t){const n=e.oxw();e.xp6(8),e.Q6J("ngForOf",n.workers)}}function me(t,a){1&t&&(e.TgZ(0,"mat-header-cell",39)(1,"span",40),e._uU(2,"Descripci\xf3n"),e.qZA()())}function ce(t,a){if(1&t&&(e.TgZ(0,"mat-cell",39)(1,"span",41),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.description)}}function se(t,a){1&t&&(e.TgZ(0,"mat-header-cell",42)(1,"span",40),e._uU(2,"Ingresos"),e.qZA()())}function ue(t,a){if(1&t&&(e.TgZ(0,"mat-cell",42)(1,"span",43),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.amount,"","es")," R$")}}function de(t,a){1&t&&(e.TgZ(0,"mat-header-cell",44)(1,"span",40),e._uU(2,"Imagen"),e.qZA()())}function pe(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"span",40)(1,"button",46),e.NdJ("click",function(){e.CHM(n);const c=e.oxw().$implicit,l=e.oxw();return e.KtG(l.openImage(c.paymentPicture))}),e._UZ(2,"span",47),e.qZA()()}}function _e(t,a){1&t&&e._UZ(0,"span",40)}function fe(t,a){if(1&t&&(e.TgZ(0,"mat-cell",44),e.YNc(1,pe,3,0,"span",45),e.YNc(2,_e,1,0,"span",45),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Q6J("ngIf",n.paymentPicture),e.xp6(1),e.Q6J("ngIf",!n.paymentPicture)}}function ge(t,a){1&t&&e._UZ(0,"mat-header-row",48)}function ve(t,a){1&t&&e._UZ(0,"mat-row",49)}function he(t,a){1&t&&(e.TgZ(0,"mat-header-cell",39)(1,"span",40),e._uU(2,"Descripci\xf3n"),e.qZA()())}function xe(t,a){if(1&t&&(e.TgZ(0,"mat-cell",39)(1,"span",41),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.description)}}function ye(t,a){1&t&&(e.TgZ(0,"mat-header-cell",42)(1,"span",40),e._uU(2,"Egresos"),e.qZA()())}function Ce(t,a){if(1&t&&(e.TgZ(0,"mat-cell",42)(1,"span",43),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.amount,"","es")," R$")}}function Ze(t,a){1&t&&e._UZ(0,"mat-header-row",48)}function be(t,a){1&t&&e._UZ(0,"mat-row",49)}function Te(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"li",57)(1,"div",7)(2,"div",58)(3,"p"),e._uU(4),e.qZA()(),e.TgZ(5,"div",59)(6,"p",32)(7,"button",60),e.NdJ("click",function(){const l=e.CHM(n).$implicit,_=e.oxw(2);return e.KtG(_.deleteComment(l.id))}),e._UZ(8,"span",61),e.qZA()()()()()}if(2&t){const n=a.$implicit;e.xp6(4),e.Oqu(n.comment)}}function Ae(t,a){1&t&&(e.TgZ(0,"div",31),e._UZ(1,"hr"),e.TgZ(2,"label",62),e._uU(3,"Agregar nuevo comentario"),e.qZA(),e._UZ(4,"textarea",63),e.qZA())}function Ue(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"button",64),e.NdJ("click",function(){e.CHM(n);const c=e.oxw(2);return e.KtG(c.blockDailyResume())}),e.TgZ(1,"span"),e._uU(2,"Bloquear"),e.qZA()()}}function De(t,a){1&t&&(e.TgZ(0,"button",65)(1,"span"),e._uU(2,"Bloqueado"),e.qZA()())}function we(t,a){if(1&t&&(e.TgZ(0,"div")(1,"h6"),e._uU(2,"Comentarios"),e.qZA(),e.TgZ(3,"div",7)(4,"div",50)(5,"ul",51),e.YNc(6,Te,9,1,"li",52),e.qZA()()(),e.YNc(7,Ae,5,0,"div",53),e.TgZ(8,"div",54),e.YNc(9,Ue,3,0,"button",55),e.YNc(10,De,3,0,"button",56),e.qZA()()),2&t){const n=e.oxw();e.xp6(6),e.Q6J("ngForOf",n.commentsFromWeek),e.xp6(1),e.Q6J("ngIf",!n.closed),e.xp6(2),e.Q6J("ngIf",!n.closed),e.xp6(1),e.Q6J("ngIf",n.closed)}}A.extend(ae),A.extend(oe),A.extend(ie),A.tz.setDefault("America/Manaus");let qe=(()=>{class t{constructor(n,o,c,l,_,v){var r=this;this.ngxUiLoaderService=n,this.movementsService=o,this.dataService=c,this.formBuilder=l,this.titleService=_,this.router=v,this.today=A.tz().format("DD/MM/YYYY"),this.amountContractsFromToday=0,this.paymentsToBeCollected=0,this.amountToBeCollected=0,this.contractsFromToday=0,this.paymentsCollected=0,this.amountCollected=0,this.expensesAmount=0,this.incomesAmount=0,this.beforeAmount=0,this.todayAmount=0,this.total=0,this.workers=[],this.commentsFromWeek=[],this.movementsFromToday=[],this.closed=!1,this.isAdmin=!1,this.displayedColumns=["details","amount"],this.displayedColumnsWithImage=["details","amount","image"],this.redirect=(m="")=>{this.router.navigate(""!==m?[`${m}`]:[Z.f.routes.dash])},this.loadData=(0,f.Z)(function*(m=!1){r.ngxUiLoaderService.startLoader("loader-02");try{const i=r.elementForm.get(["worker"]),u=yield r.movementsService.dailyResume(i?.value);if(u){const{amountContractsFromToday:g,paymentsToBeCollected:h,amountToBeCollected:U,contractsFromToday:b,movementsFromToday:F,paymentsCollected:Y,amountCollected:I,expensesAmount:B,incomesAmount:J,beforeAmount:_t,todayAmount:ft,comments:gt,workers:vt,closed:ht}=u;m||(r.workers=vt),r.amountContractsFromToday=g,r.amountToBeCollected=U,r.amountCollected=I,r.expensesAmount=B,r.incomesAmount=J,r.beforeAmount=_t,r.todayAmount=ft,r.paymentsToBeCollected=h,r.contractsFromToday=b,r.paymentsCollected=Y,r.commentsFromWeek=gt,r.closed=ht,r.total=I-g+(J-B),r.incomesDataSource=new d.by(F.incomesMovementsFromToday),r.expensesDataSource=new d.by(F.expensesMovementsFromToday)}}catch(i){r.dataService.errorHandling(i)}finally{r.ngxUiLoaderService.stopLoader("loader-02")}}),this.createForm=()=>{let m="";return this.user&&(m=this.isAdmin?"general":this.user.id),this.formBuilder.group({comment:["",s.kI.required],worker:[m,s.kI.required]})},this.createFinalMovement=(0,f.Z)(function*(){r.ngxUiLoaderService.startLoader("loader-02");try{const{comment:m,worker:i}=r.elementForm.getRawValue();yield r.movementsService.createMovement({amount:r.todayAmount,type:"final",description:"Cierre de caja",paymentPicture:"",comment:m,createdBy:i}),r.redirect(Z.f.routes.dash)}catch(m){r.dataService.errorHandling(m)}finally{r.ngxUiLoaderService.stopLoader("loader-02")}}),this.blockDailyResume=(0,f.Z)(function*(){C().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Bloquear",cancelButtonText:"Cancelar"}).then(m=>{m.isConfirmed&&r.createFinalMovement()})}),this.openImage=m=>{C().fire({title:"<strong>Imagen</strong>",html:`<div class="card"><div class="card-body"><img src="${m}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Cerrar",confirmButtonAriaLabel:"close"})},this.changeWorker=function(){var m=(0,f.Z)(function*(i){i.preventDefault(),i&&(r.elementForm.patchValue({worker:i.target.value}),r.loadData(!0))});return function(i){return m.apply(this,arguments)}}(),this.deleteComment=function(){var m=(0,f.Z)(function*(i){r.ngxUiLoaderService.startLoader("loader-02");try{yield r.movementsService.deleteComment(i),r.loadData(!0)}catch(u){r.dataService.errorHandling(u)}finally{r.ngxUiLoaderService.stopLoader("loader-02")}});return function(i){return m.apply(this,arguments)}}(),this.user=this.dataService.getLoggedUser(),(!this.dataService.getIsLoggedIn()||!this.user)&&(this.dataService.clearLoginData(),this.redirect(Z.f.routes.login)),this.user&&(this.isAdmin=["Rt","Adm"].includes(this.user.permission))}ngOnInit(){(0,x.qS)(S.Z),this.titleService.setTitle("IMPERIAL | Resumen del d\xeda"),this.elementForm=this.createForm(),this.loadData()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(D.LA),e.Y36(w),e.Y36(T.D),e.Y36(s.qu),e.Y36(q.Dx),e.Y36(y.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-daily-resume"]],decls:155,vars:67,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],["name","elementForm","novalidate","",3,"formGroup"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"col-6",2,"padding","0 !important"],[2,"text-align","left"],[1,"card-title"],[2,"text-align","right"],[4,"ngIf"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","details"],["fxFlex","auto 1 200px",4,"matHeaderCellDef"],["fxFlex","auto 1 200px",4,"matCellDef"],["matColumnDef","amount"],["fxFlex","auto 1",4,"matHeaderCellDef"],["fxFlex","auto 1",4,"matCellDef"],["matColumnDef","image"],["fxFlex","auto 1 100px",4,"matHeaderCellDef"],["fxFlex","auto 1 100px",4,"matCellDef"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",4,"matRowDef","matRowDefColumns"],[1,"mb-3"],[2,"text-align","center"],[1,"col-4",2,"padding","0 12px !important"],["for","worker",1,"form-label"],["id","worker","formControlName","worker","required","",1,"form-select",3,"change"],["value","general"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["fxFlex","auto 1 200px"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","width","100%"],["fxFlex","auto 1"],[2,"margin","0","text-align","right","width","100%"],["fxFlex","auto 1 100px"],["style","margin: 0; text-align: center; width: 100%;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"feather","icon-image"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user"],[1,"d-grid","gap-2"],[1,"list-group","list-group-flush"],["class","list-group-item",4,"ngFor","ngForOf"],["class","mb-3",4,"ngIf"],[1,"row","p-2","mt-4"],["class","btn btn-primary","type","button",3,"click",4,"ngIf"],["class","btn btn-primary","type","button","disabled","",4,"ngIf"],[1,"list-group-item"],[1,"col-10",2,"padding","0 !important"],[1,"col-2",2,"padding","0 !important"],["type","button",1,"btn","btn-red","btn-icon",3,"click"],[1,"feather","icon-x"],["for","comment",1,"form-label"],["id","comment","formControlName","comment","autocomplete","off","required","",1,"form-control"],["type","button",1,"btn","btn-primary",3,"click"],["type","button","disabled","",1,"btn","btn-primary"]],template:function(n,o){1&n&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimientos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Resumen del d\xeda"),e.qZA()()(),e.TgZ(9,"form",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",7)(15,"div",11)(16,"p",12)(17,"b",13),e._uU(18,"Resumen del d\xeda"),e.qZA()()(),e.TgZ(19,"div",11)(20,"p",14)(21,"b",13),e._uU(22),e.qZA()()()(),e.YNc(23,le,9,1,"div",15),e._UZ(24,"hr"),e.TgZ(25,"div",16)(26,"div",17)(27,"mat-table",18,19),e.ynx(29,20),e.YNc(30,me,3,0,"mat-header-cell",21),e.YNc(31,ce,3,1,"mat-cell",22),e.BQk(),e.ynx(32,23),e.YNc(33,se,3,0,"mat-header-cell",24),e.YNc(34,ue,4,5,"mat-cell",25),e.BQk(),e.ynx(35,26),e.YNc(36,de,3,0,"mat-header-cell",27),e.YNc(37,fe,3,2,"mat-cell",28),e.BQk(),e.YNc(38,ge,1,0,"mat-header-row",29),e.YNc(39,ve,1,0,"mat-row",30),e.qZA()()(),e._UZ(40,"br"),e.TgZ(41,"div",16)(42,"div",17)(43,"mat-table",18,19),e.ynx(45,20),e.YNc(46,he,3,0,"mat-header-cell",21),e.YNc(47,xe,3,1,"mat-cell",22),e.BQk(),e.ynx(48,23),e.YNc(49,ye,3,0,"mat-header-cell",24),e.YNc(50,Ce,4,5,"mat-cell",25),e.BQk(),e.YNc(51,Ze,1,0,"mat-header-row",29),e.YNc(52,be,1,0,"mat-row",30),e.qZA()()(),e._UZ(53,"br"),e.TgZ(54,"div",31)(55,"div",8)(56,"div",9)(57,"div",10)(58,"div",7)(59,"div",11)(60,"p",12)(61,"b"),e._uU(62,"Monto a cobrar en el d\xeda"),e.qZA()()(),e.TgZ(63,"div",11)(64,"p",14),e._uU(65),e.ALo(66,"number"),e.qZA()()(),e._UZ(67,"br"),e.TgZ(68,"div",7)(69,"div",11)(70,"p",12)(71,"b"),e._uU(72,"Abonos"),e.qZA()()(),e.TgZ(73,"div",11)(74,"p",14),e._uU(75),e.ALo(76,"number"),e.qZA()()(),e.TgZ(77,"div",7)(78,"div",11)(79,"p",12)(80,"b"),e._uU(81,"Ventas"),e.qZA()()(),e.TgZ(82,"div",11)(83,"p",14),e._uU(84),e.ALo(85,"number"),e.qZA()()(),e.TgZ(86,"div",7)(87,"div",11)(88,"p",12)(89,"b"),e._uU(90,"Ingresos"),e.qZA()()(),e.TgZ(91,"div",11)(92,"p",14),e._uU(93),e.ALo(94,"number"),e.qZA()()(),e.TgZ(95,"div",7)(96,"div",11)(97,"p",12)(98,"b"),e._uU(99,"Egresos"),e.qZA()()(),e.TgZ(100,"div",11)(101,"p",14),e._uU(102),e.ALo(103,"number"),e.qZA()()(),e._UZ(104,"hr"),e.TgZ(105,"div",7)(106,"div",11)(107,"p",12)(108,"b"),e._uU(109,"SALDO DEL D\xcdA"),e.qZA()()(),e.TgZ(110,"div",11)(111,"p",14),e._uU(112),e.ALo(113,"number"),e.qZA()()(),e._UZ(114,"hr"),e.TgZ(115,"div",7)(116,"div",11)(117,"p",32)(118,"b"),e._uU(119,"Caja anterior"),e.qZA(),e._UZ(120,"br"),e._uU(121),e.ALo(122,"number"),e.qZA()(),e.TgZ(123,"div",11)(124,"p",32)(125,"b"),e._uU(126,"Caja total"),e.qZA(),e._UZ(127,"br"),e._uU(128),e.ALo(129,"number"),e.qZA()()(),e._UZ(130,"hr"),e.TgZ(131,"div",7)(132,"div",33)(133,"p",32)(134,"b"),e._uU(135,"Contratos a cobrar"),e.qZA(),e._UZ(136,"br"),e._uU(137),e.ALo(138,"number"),e.qZA()(),e.TgZ(139,"div",33)(140,"p",32)(141,"b"),e._uU(142,"Contratos abonados"),e.qZA(),e._UZ(143,"br"),e._uU(144),e.ALo(145,"number"),e.qZA()(),e.TgZ(146,"div",33)(147,"p",32)(148,"b"),e._uU(149,"Contratos nuevos"),e.qZA(),e._UZ(150,"br"),e._uU(151),e.ALo(152,"number"),e.qZA()()()()()()()()()()(),e._UZ(153,"hr"),e.YNc(154,we,11,4,"div",15),e.qZA()),2&n&&(e.xp6(9),e.Q6J("formGroup",o.elementForm),e.xp6(13),e.Oqu(o.today),e.xp6(1),e.Q6J("ngIf",o.isAdmin),e.xp6(4),e.Q6J("dataSource",o.incomesDataSource),e.xp6(11),e.Q6J("matHeaderRowDef",o.displayedColumnsWithImage)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumnsWithImage),e.xp6(4),e.Q6J("dataSource",o.expensesDataSource),e.xp6(8),e.Q6J("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(13),e.hij(" ",e.Dn7(66,23,o.amountToBeCollected||0,"","es")," R$ "),e.xp6(10),e.hij(" ",e.Dn7(76,27,o.amountCollected||0,"","es")," R$ "),e.xp6(9),e.hij(" - ",e.Dn7(85,31,o.amountContractsFromToday||0,"","es")," R$ "),e.xp6(9),e.hij(" ",e.Dn7(94,35,o.incomesAmount||0,"","es")," R$ "),e.xp6(9),e.hij(" - ",e.Dn7(103,39,o.expensesAmount||0,"","es")," R$ "),e.xp6(10),e.hij(" ",e.Dn7(113,43,o.total||0,"","es")," R$ "),e.xp6(9),e.hij(" ",e.Dn7(122,47,o.beforeAmount||0,"","es")," R$ "),e.xp6(7),e.hij(" ",e.Dn7(129,51,o.todayAmount||0,"","es")," R$ "),e.xp6(9),e.hij(" ",e.Dn7(138,55,o.paymentsToBeCollected||0,"","es")," "),e.xp6(7),e.hij(" ",e.Dn7(145,59,o.paymentsCollected||0,"","es")," "),e.xp6(7),e.hij(" ",e.Dn7(152,63,o.contractsFromToday||0,"","es")," "),e.xp6(3),e.Q6J("ngIf",o.isAdmin&&"general"!==o.elementForm.getRawValue().worker))},dependencies:[y.rH,s._Y,s.YN,s.Kr,s.Fj,s.EJ,s.JJ,s.JL,s.Q7,x.sg,x.O5,M.YE,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,R.yH,s.sg,s.u,x.JJ],styles:[".ngx-datatable[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]{display:none!important}"]}),t})();var N=p(7317),Fe=p(6811),Se=p(4074),Me=p(5580);function Re(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",34)(1,"img",35),e.NdJ("click",function(){e.CHM(n);const c=e.oxw();return e.KtG(c.openImage("payment"))}),e.qZA()()}if(2&t){const n=e.oxw();e.xp6(1),e.Q6J("src",n.paymentImage,e.LSH)}}class Ye{constructor(a,n){this.src=a,this.file=n}}let ke=(()=>{class t{constructor(n,o,c,l,_,v,r,m){var i=this;this.ngxUiLoaderService=n,this.movementsService=o,this.imagesService=c,this.dataService=l,this.formBuilder=_,this.matDialog=v,this.titleService=r,this.router=m,this.paymentImage=null,this.uploader=new N.bA({allowedMimeType:["image/png","image/jpg","image/jpeg"],maxFileSize:1048576,autoUpload:!1,isHTML5:!0,url:""}),this.createForm=()=>this.formBuilder.group({type:["",s.kI.required],amount:["",s.kI.required],description:["",s.kI.required]}),this.redirect=(u="")=>{this.router.navigate(""!==u?[`${u}`]:[Z.f.routes.dash])},this.createPayment=function(){var u=(0,f.Z)(function*(g){i.ngxUiLoaderService.startLoader("loader-02");try{g.preventDefault();let h=null;if(!i.paymentImage)return void i.dataService.errorHandling({front:!0,message:"La imagen del movimiento es obligatoria, verifique e intente nuevamente."});h=yield i.imagesService.createImage({base64:i.paymentImage,type:"payment"});const U=i.elementForm.getRawValue(),{type:b,amount:F,description:Y}=U;yield i.movementsService.createMovement({type:b,amount:F,description:Y,paymentPicture:h?.id||""}),i.redirect(Z.f.routes.dash)}catch(h){i.dataService.errorHandling(h)}finally{i.ngxUiLoaderService.stopLoader("loader-02")}});return function(g){return u.apply(this,arguments)}}(),this.openImage=u=>{let g="",h="";"payment"===u&&(g="pago",h=this.paymentImage),C().fire({title:`<strong>Foto del ${g}</strong>`,html:`<div class="card"><div class="card-body"><img src="${h}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Cerrar",confirmButtonAriaLabel:"close"})},this.openCamera=u=>{this.cameraDialogRef=this.matDialog.open(Fe.M,{autoFocus:!0,disableClose:!0,height:"90vh",minWidth:"95vw"}),this.cameraDialogRef.afterClosed().subscribe(function(){var g=(0,f.Z)(function*(h){h&&"payment"===u&&(i.paymentImage=h),i.cameraDialogRef=null});return function(h){return g.apply(this,arguments)}}())},this.uploadFile=u=>{const g=u.files[0],h=new FileReader;h.addEventListener("load",function(){var U=(0,f.Z)(function*(b){i.selectedFile=new Ye(b.target.result,g),i.paymentImage=b.target.result});return function(b){return U.apply(this,arguments)}}()),h.readAsDataURL(g)},this.dataService.clearCreatedUser()}ngOnInit(){this.titleService.setTitle("IMPERIAL | Registrar movimiento"),this.elementForm=this.createForm()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(D.LA),e.Y36(w),e.Y36(Se.C),e.Y36(T.D),e.Y36(s.qu),e.Y36(Me.uw),e.Y36(q.Dx),e.Y36(y.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create"]],decls:52,vars:5,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],["name","elementForm","novalidate","",3,"formGroup"],[1,"mb-3"],["for","type",1,"form-label"],["id","type","formControlName","type","required","",1,"form-select"],["value","in","selected",""],["value","out"],["for","amount",1,"form-label"],[1,"input-group"],["placement","bottom","ngbTooltip","Tooltip on bottom",1,"input-group-text","hover"],["type","text","id","amount","name","amount","appInputRestriction","float","formControlName","amount","oninput","this.value=this.value.replace(/[^0-9]/g,'')","required","",1,"form-control",2,"text-align","right","padding-right","1em"],["for","description",1,"form-label"],["id","description","formControlName","description","autocomplete","off","required","",1,"form-control"],[1,"row","mb-3"],["class","col-12","style","text-align: center",4,"ngIf"],[1,"col-12"],["id","formFile","type","file","accept","image/png,image/jpeg","ng2FileSelect","",1,"form-control",3,"uploader","change"],["fileInput",""],[1,"d-grid","gap-2"],["href","","href","javascript:void(0)",1,"btn","btn-primary",3,"click"],[1,"feather","icon-camera"],[2,"text-align","center"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled","click"],[1,"btn","btn-secondary",3,"routerLink","click"],[1,"col-12",2,"text-align","center"],["alt","...",1,"card-img-top",3,"src","click"]],template:function(n,o){if(1&n){const c=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimientos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Registrar"),e.qZA()()(),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"h6",10),e._uU(14,"Registrar"),e.qZA(),e.TgZ(15,"form",11)(16,"div",12)(17,"label",13),e._uU(18,"Forma"),e.qZA(),e.TgZ(19,"select",14)(20,"option",15),e._uU(21,"Ingreso"),e.qZA(),e.TgZ(22,"option",16),e._uU(23,"Egreso"),e.qZA()()(),e.TgZ(24,"div",12)(25,"label",17),e._uU(26,"Monto"),e.qZA(),e.TgZ(27,"div",18)(28,"span",19),e._uU(29,"R$"),e.qZA(),e._UZ(30,"input",20),e.qZA()(),e.TgZ(31,"div",12)(32,"label",21),e._uU(33,"Descripci\xf3n"),e.qZA(),e._UZ(34,"textarea",22),e.qZA(),e.TgZ(35,"div",23),e.YNc(36,Re,2,1,"div",24),e.qZA(),e.TgZ(37,"div",23)(38,"div",25)(39,"input",26,27),e.NdJ("change",function(){e.CHM(c);const _=e.MAs(40);return e.KtG(o.uploadFile(_))}),e.qZA()()(),e.TgZ(41,"div",23)(42,"div",25)(43,"div",28)(44,"a",29),e.NdJ("click",function(){return o.openCamera("payment")}),e._UZ(45,"span",30),e.qZA()()()(),e._UZ(46,"hr"),e.TgZ(47,"div",31)(48,"button",32),e.NdJ("click",function(_){return o.createPayment(_)}),e._uU(49,"Aceptar"),e.qZA(),e.TgZ(50,"button",33),e.NdJ("click",function(){return!1}),e._uU(51,"Cancelar"),e.qZA()()()()()()()}2&n&&(e.xp6(15),e.Q6J("formGroup",o.elementForm),e.xp6(21),e.Q6J("ngIf",o.paymentImage),e.xp6(3),e.Q6J("uploader",o.uploader),e.xp6(9),e.Q6J("disabled",o.elementForm.invalid),e.xp6(2),e.Q6J("routerLink","/admin/dashboard"))},dependencies:[y.rH,s._Y,s.YN,s.Kr,s.Fj,s.EJ,s.JJ,s.JL,s.Q7,x.O5,N.C6,L._L,s.sg,s.u]}),t})();var P=p(2417),Le=p(8405);function Ne(t,a){1&t&&(e.TgZ(0,"div",11)(1,"span",24)(2,"h6",25),e._uU(3,"Seleccione un tipo de movimiento"),e.qZA()()())}function Pe(t,a){1&t&&(e.TgZ(0,"mat-header-cell",41)(1,"span",42),e._uU(2,"Creado por"),e.qZA()())}function Ie(t,a){if(1&t&&(e.TgZ(0,"mat-cell",41)(1,"span",43),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.createdBy.getFullName())}}function Be(t,a){1&t&&(e.TgZ(0,"mat-header-cell",41)(1,"span",42),e._uU(2,"Cliente"),e.qZA()())}function Je(t,a){if(1&t&&(e.TgZ(0,"mat-cell",41)(1,"span",43),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.client.getFullName())}}function He(t,a){1&t&&(e.TgZ(0,"mat-header-cell",44)(1,"span",42),e._uU(2,"Monto prestado"),e.qZA()())}function Qe(t,a){if(1&t&&(e.TgZ(0,"mat-cell",44)(1,"span",45),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.loanAmount,"","es")," R$")}}function $e(t,a){1&t&&(e.TgZ(0,"mat-header-cell",44)(1,"span",42),e._uU(2,"Pagos"),e.qZA()())}function Ee(t,a){if(1&t&&(e.TgZ(0,"mat-cell",44)(1,"span",42),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(e.Dn7(3,1,n.payments,"","es"))}}function Ve(t,a){1&t&&(e.TgZ(0,"mat-header-cell",46)(1,"span",42),e._uU(2,"Anular"),e.qZA()())}function je(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"mat-cell",46)(1,"span",42)(2,"button",47),e.NdJ("click",function(){const l=e.CHM(n).$implicit,_=e.oxw(2);return e.KtG(_.cancelMovement(l,!0))}),e._UZ(3,"span",48),e.qZA()()()}}function Oe(t,a){1&t&&e._UZ(0,"mat-header-row",49)}function Ge(t,a){1&t&&e._UZ(0,"mat-row",50)}function Ke(t,a){if(1&t&&(e.TgZ(0,"mat-table",26,27),e.ynx(2,28),e.YNc(3,Pe,3,0,"mat-header-cell",29),e.YNc(4,Ie,3,1,"mat-cell",30),e.BQk(),e.ynx(5,31),e.YNc(6,Be,3,0,"mat-header-cell",29),e.YNc(7,Je,3,1,"mat-cell",30),e.BQk(),e.ynx(8,32),e.YNc(9,He,3,0,"mat-header-cell",33),e.YNc(10,Qe,4,5,"mat-cell",34),e.BQk(),e.ynx(11,35),e.YNc(12,$e,3,0,"mat-header-cell",33),e.YNc(13,Ee,4,5,"mat-cell",34),e.BQk(),e.ynx(14,36),e.YNc(15,Ve,3,0,"mat-header-cell",37),e.YNc(16,je,4,0,"mat-cell",38),e.BQk(),e.YNc(17,Oe,1,0,"mat-header-row",39),e.YNc(18,Ge,1,0,"mat-row",40),e.qZA()),2&t){const n=e.oxw();e.Q6J("dataSource",n.dataSource),e.xp6(17),e.Q6J("matHeaderRowDef",n.contractColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",n.contractColumns)}}function We(t,a){1&t&&(e.TgZ(0,"mat-header-cell",41)(1,"span",42),e._uU(2,"Descripci\xf3n"),e.qZA()())}function ze(t,a){if(1&t&&(e.TgZ(0,"mat-cell",41)(1,"span",43),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.description)}}function Xe(t,a){1&t&&(e.TgZ(0,"mat-header-cell",44)(1,"span",42),e._uU(2,"Ingresos"),e.qZA()())}function et(t,a){if(1&t&&(e.TgZ(0,"mat-cell",44)(1,"span",45),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.amount,"","es")," R$")}}function tt(t,a){1&t&&(e.TgZ(0,"mat-header-cell",46)(1,"span",42),e._uU(2,"Imagen"),e.qZA()())}function nt(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"span",42)(1,"button",55),e.NdJ("click",function(){e.CHM(n);const c=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.openImage(c.paymentPicture))}),e._UZ(2,"span",56),e.qZA()()}}function at(t,a){1&t&&e._UZ(0,"span",42)}function ot(t,a){if(1&t&&(e.TgZ(0,"mat-cell",46),e.YNc(1,nt,3,0,"span",54),e.YNc(2,at,1,0,"span",54),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Q6J("ngIf",n.paymentPicture),e.xp6(1),e.Q6J("ngIf",!n.paymentPicture)}}function it(t,a){1&t&&(e.TgZ(0,"mat-header-cell",46)(1,"span",42),e._uU(2,"Anular"),e.qZA()())}function rt(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"mat-cell",46)(1,"span",42)(2,"button",47),e.NdJ("click",function(){const l=e.CHM(n).$implicit,_=e.oxw(2);return e.KtG(_.cancelMovement(l))}),e._UZ(3,"span",48),e.qZA()()()}}function lt(t,a){1&t&&e._UZ(0,"mat-header-row",49)}function mt(t,a){1&t&&e._UZ(0,"mat-row",50)}function ct(t,a){if(1&t&&(e.TgZ(0,"mat-table",26,27),e.ynx(2,51),e.YNc(3,We,3,0,"mat-header-cell",29),e.YNc(4,ze,3,1,"mat-cell",30),e.BQk(),e.ynx(5,52),e.YNc(6,Xe,3,0,"mat-header-cell",33),e.YNc(7,et,4,5,"mat-cell",34),e.BQk(),e.ynx(8,53),e.YNc(9,tt,3,0,"mat-header-cell",37),e.YNc(10,ot,3,2,"mat-cell",38),e.BQk(),e.ynx(11,36),e.YNc(12,it,3,0,"mat-header-cell",37),e.YNc(13,rt,4,0,"mat-cell",38),e.BQk(),e.YNc(14,lt,1,0,"mat-header-row",39),e.YNc(15,mt,1,0,"mat-row",40),e.qZA()),2&t){const n=e.oxw();e.Q6J("dataSource",n.dataSource),e.xp6(14),e.Q6J("matHeaderRowDef",n.movementColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",n.movementColumns)}}let st=(()=>{class t{constructor(n,o,c,l,_,v,r){var m=this;this.ngxUiLoaderService=n,this.movementsService=o,this.contractsService=c,this.dataService=l,this.formBuilder=_,this.titleService=v,this.router=r,this.movementColumns=["details","amount","image","options"],this.contractColumns=["createdBy","client","loanAmount","payments","options"],this.createForm=()=>this.formBuilder.group({type:[null,s.kI.required]}),this.redirect=(i="")=>{this.router.navigate(""!==i?[`${i}`]:[Z.f.routes.dash])},this.loadData=(0,f.Z)(function*(){m.ngxUiLoaderService.startLoader("loader-02");try{let i;const{type:u}=m.elementForm.getRawValue();"contract"===u?(i=yield m.contractsService.contractsFromToday(),i.data=i.data.map(g=>(g.createdBy=new P.T(g.createdBy),g.client=new P.T(g.client),g)),console.log("\u{1f680} ~ file: cancel.component.ts:88 ~ MovementCancelComponent ~ response.data=response.data.map ~ response.data:",i.data)):i=yield m.movementsService.movementsFromToday(u),i&&(m.dataSource=new d.by(i.data))}catch(i){m.dataService.errorHandling(i)}finally{m.ngxUiLoaderService.stopLoader("loader-02")}}),this.sendPayment=function(){var i=(0,f.Z)(function*(u,g=!1){try{m.ngxUiLoaderService.startLoader("loader-02"),g?yield m.contractsService.cancelContract(u.id):yield m.movementsService.cancelMovement(u.id),m.loadData()}catch(h){m.dataService.errorHandling(h)}finally{m.ngxUiLoaderService.stopLoader("loader-02")}});return function(u){return i.apply(this,arguments)}}(),this.changeType=i=>{i.preventDefault(),i&&(this.elementForm.patchValue({type:i.target.value}),this.loadData())},this.cancelMovement=function(){var i=(0,f.Z)(function*(u,g=!1){C().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Anular",cancelButtonText:"Cancelar"}).then(h=>{h.isConfirmed&&m.sendPayment(u,g)})});return function(u){return i.apply(this,arguments)}}(),this.openImage=i=>{C().fire({title:"<strong>Imagen</strong>",html:`<div class="card"><div class="card-body"><img src="${i}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Cerrar",confirmButtonAriaLabel:"close"})},this.dataService.clearCreatedUser()}ngOnInit(){(0,x.qS)(S.Z),this.titleService.setTitle("IMPERIAL | Registrar movimiento"),this.elementForm=this.createForm()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(D.LA),e.Y36(w),e.Y36(Le.W),e.Y36(T.D),e.Y36(s.qu),e.Y36(q.Dx),e.Y36(y.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-cancel"]],decls:35,vars:5,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],["name","elementForm","novalidate","",3,"formGroup"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"mb-3"],["for","type",1,"form-label"],["id","type","formControlName","type","required","",1,"form-select",3,"change"],["value","payment"],["value","contract"],["value","expense"],["value","income"],["class","mb-3",4,"ngIf"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["class","common-table","matSort","",3,"dataSource",4,"ngIf"],[2,"text-align","center"],[1,"btn","btn-secondary",3,"routerLink","click"],[2,"text-align","center","width","100%"],[1,"card-title"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","createdBy"],["fxFlex","auto 1 200px",4,"matHeaderCellDef"],["fxFlex","auto 1 200px",4,"matCellDef"],["matColumnDef","client"],["matColumnDef","loanAmount"],["fxFlex","auto 1",4,"matHeaderCellDef"],["fxFlex","auto 1",4,"matCellDef"],["matColumnDef","payments"],["matColumnDef","options"],["fxFlex","auto 1 100px",4,"matHeaderCellDef"],["fxFlex","auto 1 100px",4,"matCellDef"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",4,"matRowDef","matRowDefColumns"],["fxFlex","auto 1 200px"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","width","100%"],["fxFlex","auto 1"],[2,"margin","0","text-align","right","width","100%"],["fxFlex","auto 1 100px"],["type","button",1,"btn","btn-red","btn-icon",3,"click"],[1,"feather","icon-trash"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user"],["matColumnDef","details"],["matColumnDef","amount"],["matColumnDef","image"],["style","margin: 0; text-align: center; width: 100%;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"feather","icon-image"]],template:function(n,o){1&n&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimientos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Anular"),e.qZA()()(),e.TgZ(9,"form",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11)(15,"label",12),e._uU(16,"Tipo de movimiento"),e.qZA(),e.TgZ(17,"select",13),e.NdJ("change",function(l){return o.changeType(l)}),e.TgZ(18,"option",14),e._uU(19,"Abono"),e.qZA(),e.TgZ(20,"option",15),e._uU(21,"Contrato"),e.qZA(),e.TgZ(22,"option",16),e._uU(23,"Egreso"),e.qZA(),e.TgZ(24,"option",17),e._uU(25,"Ingreso"),e.qZA()()(),e.YNc(26,Ne,4,0,"div",18),e.TgZ(27,"div",19)(28,"div",20),e.YNc(29,Ke,19,4,"mat-table",21),e.YNc(30,ct,16,4,"mat-table",21),e.qZA()(),e._UZ(31,"hr"),e.TgZ(32,"div",22)(33,"button",23),e.NdJ("click",function(){return!1}),e._uU(34,"Cerrar"),e.qZA()()()()()()()),2&n&&(e.xp6(9),e.Q6J("formGroup",o.elementForm),e.xp6(17),e.Q6J("ngIf",!o.elementForm.getRawValue().type),e.xp6(3),e.Q6J("ngIf","contract"===o.elementForm.getRawValue().type),e.xp6(1),e.Q6J("ngIf",o.elementForm.getRawValue().type&&"contract"!==o.elementForm.getRawValue().type),e.xp6(3),e.Q6J("routerLink","/admin/dashboard"))},dependencies:[y.rH,s._Y,s.YN,s.Kr,s.EJ,s.JJ,s.JL,s.Q7,x.O5,M.YE,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,R.yH,s.sg,s.u,x.JJ]}),t})();var ut=p(6356);const dt=[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:ke},{path:"daily-resume",component:qe},{path:"validation-payments-pending",component:ne},{path:"cancel-movement",component:st}];let pt=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.Bz.forChild(dt),s.u5,ut.A,s.UX]}),t})()}}]);