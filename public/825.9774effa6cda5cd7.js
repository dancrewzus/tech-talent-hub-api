"use strict";(self.webpackChunkimperial=self.webpackChunkimperial||[]).push([[825],{6825:(z,R,f)=>{f.r(R),f.d(R,{ContractsModule:()=>yt});var h=f(9562),y=f(5030),v=f(5861),g=f(4755);var E=(()=>((E=E||{}).standard="standard",E.flex="flex",E.force="force",E))();const W={},Q=typeof document<"u"?document.createElement("div").style:void 0,$=function(){const n=typeof window<"u"?window.getComputedStyle(document.documentElement,""):void 0,i=typeof n<"u"?Array.prototype.slice.call(n).join("").match(/-(moz|webkit|ms)-/):null,e=null!==i?i[1]:void 0,o=typeof e<"u"?"WebKit|Moz|MS|O".match(new RegExp("("+e+")","i"))[1]:void 0;return o?{dom:o,lowercase:e,css:`-${e}-`,js:e[0].toUpperCase()+e.substr(1)}:void 0}();function Z(n){const i=function U(n){return(n=(n=(n=n.replace(/[^a-zA-Z0-9 ]/g," ")).replace(/([a-z](?=[A-Z]))/g,"$1 ")).replace(/([^a-zA-Z0-9 ])|^[0-9]+/g,"").trim().toLowerCase()).replace(/([ 0-9]+)([a-zA-Z])/g,function(i,e,o){return e.trim()+o.toUpperCase()})}(n);return W[i]||(void 0!==$&&void 0!==Q[$.css+n]?W[i]=$.css+n:void 0!==Q[n]&&(W[i]=n)),W[i]}typeof window<"u"&&Z("transform"),typeof window<"u"&&Z("backfaceVisibility"),typeof window<"u"&&Z("transform"),typeof window<"u"&&Z("perspective");const K=typeof window<"u"?window.navigator.userAgent:"Chrome";/Safari\//.test(K)&&/Chrome\//.test(K),typeof document<"u"&&!document.elementsFromPoint&&(document.elementsFromPoint=function $e(n,i){const e=[],o=[];let a,r,c;for(;(a=document.elementFromPoint(n,i))&&-1===e.indexOf(a)&&null!=a;)e.push(a),o.push({value:a.style.getPropertyValue("pointer-events"),priority:a.style.getPropertyPriority("pointer-events")}),a.style.setProperty("pointer-events","none","important");for(r=o.length;c=o[--r];)e[r].style.setProperty("pointer-events",c.value?c.value:"",c.priority);return e});var ee=f(7228),M=f(1764),I=f(2534),Ne=f(274),Le=f(1545),Ge=f(5268),t=f(2223),te=f(8405),L=f(7066),Xe=f(9089);function qe(n,i){if(1&n&&(t.TgZ(0,"option",30),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.s9C("value",e.value),t.xp6(1),t.Oqu(e.title)}}function je(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",31)(2,"input",34),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw(3);return t.KtG(r.setNonWorkingDays(a))}),t.qZA(),t.TgZ(3,"label",35),t._uU(4,"Lunes"),t.qZA()(),t.TgZ(5,"div",31)(6,"input",36),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw(3);return t.KtG(r.setNonWorkingDays(a))}),t.qZA(),t.TgZ(7,"label",37),t._uU(8,"Martes"),t.qZA()(),t.TgZ(9,"div",31)(10,"input",38),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw(3);return t.KtG(r.setNonWorkingDays(a))}),t.qZA(),t.TgZ(11,"label",39),t._uU(12,"Mi\xe9rcoles"),t.qZA()(),t.TgZ(13,"div",31)(14,"input",40),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw(3);return t.KtG(r.setNonWorkingDays(a))}),t.qZA(),t.TgZ(15,"label",41),t._uU(16,"Jueves"),t.qZA()(),t.TgZ(17,"div",31)(18,"input",42),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw(3);return t.KtG(r.setNonWorkingDays(a))}),t.qZA(),t.TgZ(19,"label",43),t._uU(20,"Viernes"),t.qZA()(),t.TgZ(21,"div",31)(22,"input",44),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw(3);return t.KtG(r.setNonWorkingDays(a))}),t.qZA(),t.TgZ(23,"label",45),t._uU(24,"S\xe1bado"),t.qZA()()()}}function Ye(n,i){if(1&n&&(t.TgZ(0,"div")(1,"div",31),t._UZ(2,"input",32),t.TgZ(3,"label",33),t._uU(4,"Domingo"),t.qZA()(),t.YNc(5,je,25,0,"div",26),t.qZA()),2&n){const e=t.oxw(2);t.xp6(5),t.Q6J("ngIf",e.acceptDaysOff)}}function Qe(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"h6",12),t._uU(5,"Contrato"),t.qZA(),t.TgZ(6,"form",13)(7,"div",14)(8,"span")(9,"b"),t._uU(10,"CPF:"),t.qZA(),t._uU(11),t.qZA(),t._UZ(12,"br"),t.TgZ(13,"span")(14,"b"),t._uU(15,"Nombre:"),t.qZA(),t._uU(16),t.qZA(),t._UZ(17,"br"),t.TgZ(18,"span")(19,"b"),t._uU(20,"Apellido:"),t.qZA(),t._uU(21),t.qZA(),t._UZ(22,"br"),t.TgZ(23,"span")(24,"b"),t._uU(25,"N\xfamero de tel\xe9fono:"),t.qZA(),t._uU(26),t.qZA(),t._UZ(27,"br"),t.TgZ(28,"span")(29,"b"),t._uU(30,"Fecha del \xfaltimo contrato:"),t.qZA(),t._uU(31),t.qZA(),t._UZ(32,"br"),t.qZA(),t._UZ(33,"hr"),t.TgZ(34,"div",14)(35,"label",15),t._uU(36,"Tipo de contrato"),t.qZA(),t.TgZ(37,"select",16),t.NdJ("change",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.setModality())}),t.TgZ(38,"option",17),t._uU(39,"Diario"),t.qZA(),t.TgZ(40,"option",18),t._uU(41,"Semanal"),t.qZA()()(),t.TgZ(42,"div",14)(43,"label",19),t._uU(44,"Modo de pago"),t.qZA(),t.TgZ(45,"select",20),t.NdJ("change",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.calculateTotal())}),t.YNc(46,qe,2,2,"option",21),t.qZA()(),t.TgZ(47,"div",14)(48,"label",22),t._uU(49,"Cantidad a prestar"),t.qZA(),t.TgZ(50,"div",23)(51,"span",24),t._uU(52,"R$"),t.qZA(),t.TgZ(53,"input",25),t.NdJ("change",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.calculateTotal())}),t.qZA()()(),t.TgZ(54,"div",14)(55,"span")(56,"b"),t._uU(57),t.qZA(),t._uU(58),t.ALo(59,"number"),t.qZA(),t._UZ(60,"br"),t.TgZ(61,"span")(62,"b"),t._uU(63,"TOTAL:"),t.qZA(),t._uU(64),t.ALo(65,"number"),t.qZA(),t._UZ(66,"br"),t.qZA(),t.TgZ(67,"h4"),t._uU(68),t.qZA(),t._UZ(69,"br"),t.YNc(70,Ye,6,1,"div",26),t._UZ(71,"hr"),t.TgZ(72,"div",27)(73,"button",28),t.NdJ("click",function(a){t.CHM(e);const r=t.oxw();return t.KtG(r.createContract(a))}),t._uU(74,"Aceptar"),t.qZA(),t.TgZ(75,"button",29),t.NdJ("click",function(){return!1}),t._uU(76,"Cancelar"),t.qZA()()()()()()()}if(2&n){const e=t.oxw();t.xp6(6),t.Q6J("formGroup",e.elementForm),t.xp6(5),t.hij(" ",e.elementForm.getRawValue().cpf,""),t.xp6(5),t.hij(" ",e.elementForm.getRawValue().name,""),t.xp6(5),t.hij(" ",e.elementForm.getRawValue().lastname,""),t.xp6(5),t.hij(" ",e.elementForm.getRawValue().phone,""),t.xp6(5),t.hij(" ",e.elementForm.getRawValue().lastContract,""),t.xp6(15),t.Q6J("ngForOf",e.modalityOptions),t.xp6(11),t.hij("PAGO POR ","daily"===e.modalityType?"DIA":"SEMANA",":"),t.xp6(1),t.hij(" ",t.Dn7(59,14,e.elementForm.getRawValue().paymentAmount,"","es")," R$"),t.xp6(6),t.hij(" ",t.Dn7(65,18,e.elementForm.getRawValue().totalAmount,"","es")," R$"),t.xp6(4),t.Oqu(e.dayMessage),t.xp6(2),t.Q6J("ngIf","daily"===e.modalityType),t.xp6(3),t.Q6J("disabled",e.elementForm.invalid),t.xp6(2),t.Q6J("routerLink","/admin/dashboard")}}M.extend(Ne),M.extend(Le),M.extend(Ge),M.tz.setDefault("America/Manaus");let Ke=(()=>{class n{constructor(e,o,a,r,c){var s=this;this.changeDetectorRefs=e,this.contractsService=o,this.dataService=a,this.formBuilder=r,this.router=c,this.rows=[],this.allModalityOptions=[],this.modalityOptions=[],this.loadingIndicator=!0,this.ColumnMode=E,this.createdUser=null,this.dayMessage="Dias no laborables",this.modalityType="daily",this.acceptDaysOff=!1,this.focusedInputs={loanAmount:!1},this.today=M().day(),this.redirect=(l="")=>{this.router.navigate(""!==l?[`${l}`]:[I.f.routes.dash])},this.createForm=()=>this.formBuilder.group({cpf:["",y.kI.required],name:["",y.kI.required],lastname:["",y.kI.required],phone:["",y.kI.required],lastContract:["",y.kI.required],modality:["",y.kI.required],modalityOptions:["",y.kI.required],loanAmount:["",y.kI.required],percent:["",y.kI.required],payments:["",y.kI.required],totalAmount:["",y.kI.required],paymentAmount:["",y.kI.required],dailySunday:[!0],dailyMonday:[!1],dailyTuesday:[!1],dailyWednesday:[!1],dailyThursday:[!1],dailyFriday:[!1],dailySaturday:[!1],weeklySunday:[!1],weeklyMonday:[!1],weeklyTuesday:[!1],weeklyWednesday:[!1],weeklyThursday:[!1],weeklyFriday:[!1],weeklySaturday:[!1]}),this.patchForm=l=>{const d=this.modalityOptions.length?this.modalityOptions[0]:null;this.elementForm.patchValue({cpf:this.createdUser?this.createdUser.cpf:"",name:this.createdUser?this.createdUser.firstName:"",lastname:this.createdUser?this.createdUser.paternalSurname:"",phone:this.createdUser?this.createdUser.phoneNumber:"",lastContract:l,modality:"daily",modalityOptions:d?.value||null,loanAmount:null,percent:null,payments:null,totalAmount:"0",paymentAmount:"0"}),this.elementForm.controls.dailySunday.disable(),this.acceptDaysOff=d?.offDays||!1,this.createdUser&&(this.elementForm.controls.cpf.disable(),this.elementForm.controls.name.disable(),this.elementForm.controls.lastname.disable(),this.elementForm.controls.phone.disable()),this.elementForm.controls.totalAmount.disable(),this.elementForm.controls.paymentAmount.disable()},this.loadData=(0,v.Z)(function*(){try{let l=null,d="Sin informaci\xf3n";const u=yield s.contractsService.loadModalities();if(s.allModalityOptions=u?.data||[],s.modalityOptions=s.allModalityOptions.filter(p=>p.type===s.modalityType),s.createdUser){const p=yield s.contractsService.loadContractData(s.createdUser.id);p?.length>0&&(l=p[0],l.status&&(s.dataService.errorHandling({front:!0,message:"El cliente tiene un contrato ativo"}),s.redirect()),d=l.lastContractDate)}s.loadingIndicator=!1,s.patchForm(d)}catch(l){s.dataService.errorHandling(l)}}),this.createContract=function(){var l=(0,v.Z)(function*(d){try{d.preventDefault();const u=s.elementForm.getRawValue();let p="";const{lastContract:m,modality:_,modalityOptions:x,loanAmount:H,percent:b,payments:q,totalAmount:bt,paymentAmount:wt,dailySunday:_t,dailyMonday:vt,dailyTuesday:xt,dailyWednesday:Ct,dailyThursday:Tt,dailyFriday:Dt,dailySaturday:St,weeklySunday:It,weeklyMonday:Ht,weeklyTuesday:Rt,weeklyWednesday:kt,weeklyThursday:Pt,weeklyFriday:Et,weeklySaturday:At}=u;"daily"===_?(_t&&(p=`${p}Sun`),vt&&(p=`${p}Mon`),xt&&(p=`${p}Tue`),Ct&&(p=`${p}Wed`),Tt&&(p=`${p}Thu`),Dt&&(p=`${p}Fri`),St&&(p=`${p}Sat`)):(It&&(p=`${p}Sun`),Ht&&(p=`${p}Mon`),Rt&&(p=`${p}Tue`),kt&&(p=`${p}Wed`),Pt&&(p=`${p}Thu`),Et&&(p=`${p}Fri`),At&&(p=`${p}Sat`));const Mt={lastContractDate:"Sin informaci\xf3n"===m?null:m,client:s.createdUser?s.createdUser?.id:"",modality:u.modality,modalityOptions:x,loanAmount:H,percent:b,payments:q,totalAmount:bt,paymentAmount:wt,nonWorkingDays:p};yield s.contractsService.createContract(Mt),s.redirect(I.f.routes.dash)}catch(u){s.dataService.errorHandling(u)}});return function(d){return l.apply(this,arguments)}}(),this.calculateTotal=()=>{this.elementForm.patchValue({totalAmount:"0",paymentAmount:"0"});const l=this.elementForm.getRawValue(),d=this.modalityOptions.find(q=>q.value===l.modalityOptions),u=d?.percent||"0",p="daily"===d?.type?d?.days:d?.weeks||"0",m=Number.parseInt(l.loanAmount),_=Number.parseInt(u),x=Number.parseInt(p),H=m*(_/100)+m,b=x>0?H/x:0;this.acceptDaysOff=d?.offDays||!1,this.elementForm.patchValue({totalAmount:isNaN(H)?0:Number.parseInt(`${H}`),paymentAmount:isNaN(b)?0:Number.parseInt(`${b}`),payments:x,percent:_})},this.setModality=()=>{const d=this.elementForm.getRawValue().modality;this.modalityType=d,this.modalityOptions=this.allModalityOptions.filter(u=>u.type===this.modalityType),"daily"===d?(this.dayMessage="Dias no laborables",this.elementForm.patchValue({dailySunday:!0,dailyMonday:!1,dailyTuesday:!1,dailyWednesday:!1,dailyThursday:!1,dailyFriday:!1,dailySaturday:!1,modalityOptions:this.modalityOptions[0].value})):(this.dayMessage="Dia de pago: "+this.getSelectedDay(),this.elementForm.patchValue({weeklySunday:0===this.today,weeklyMonday:1===this.today,weeklyTuesday:2===this.today,weeklyWednesday:3===this.today,weeklyThursday:4===this.today,weeklyFriday:5===this.today,weeklySaturday:6===this.today,modalityOptions:this.modalityOptions[0].value})),this.changeDetectorRefs.detectChanges()},this.getSelectedDay=()=>{let l;switch(this.today){case 0:l="Domingo";break;case 1:l="Lunes";break;case 2:l="Martes";break;case 3:l="Mi\xe9rcoles";break;case 4:l="Jueves";break;case 5:l="Viernes";break;case 6:l="S\xe1bado";break;default:l=""}return l},this.setNonWorkingDays=l=>{if(l.currentTarget.checked){const d=this.elementForm.getRawValue();if("daily"===d.modality)for(const u in d)Object.prototype.hasOwnProperty.call(d,u)&&u.includes("daily")&&u!==l.currentTarget.name&&"dailySunday"!==u&&(d[u]=!1);this.elementForm.patchValue({...d}),this.changeDetectorRefs.detectChanges()}}}ngOnInit(){(0,g.qS)(ee.Z),this.createdUser=this.dataService.getCreatedUser()??null,this.createdUser||(this.dataService.errorHandling({front:!0,message:"Debes seleccionar un cliente"}),this.redirect(I.f.routes.contractsPending)),this.elementForm=this.createForm(),this.loadData()}ngOnDestroy(){this.dataService.clearCreatedUser()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(te.W),t.Y36(L.D),t.Y36(y.qu),t.Y36(h.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-contracts-create"]],decls:11,vars:1,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["routerLink","/admin/contracts/list"],["aria-current","page",1,"breadcrumb-item","active"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],["name","elementForm","novalidate","",3,"formGroup"],[1,"mb-3"],["for","modality",1,"form-label"],["id","modality","formControlName","modality","required","",1,"form-select",3,"change"],["value","daily","selected",""],["value","weekly"],["for","modalityOptions",1,"form-label"],["id","modalityOptions","formControlName","modalityOptions","required","",1,"form-select",3,"change"],["selected","",3,"value",4,"ngFor","ngForOf"],["for","loanAmount",1,"form-label"],[1,"input-group"],["placement","bottom","ngbTooltip","Tooltip on bottom",1,"input-group-text","hover"],["type","text","id","loanAmount","name","loanAmount","appInputRestriction","float","formControlName","loanAmount","oninput","this.value=this.value.replace(/[^0-9]/g,'')","required","",1,"form-control",2,"text-align","right","padding-right","1em",3,"change"],[4,"ngIf"],[2,"text-align","center"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled","click"],[1,"btn","btn-secondary",3,"routerLink","click"],["selected","",3,"value"],[1,"form-check","mb-1"],["type","checkbox","formControlName","dailySunday","name","dailySunday","id","dailySunday",1,"form-check-input","pr-2"],["for","dailySunday",1,"form-label","pl-2"],["type","checkbox","formControlName","dailyMonday","name","dailyMonday","id","dailyMonday",1,"form-check-input","pr-2",3,"change"],["for","dailyMonday",1,"form-label","pl-2"],["type","checkbox","formControlName","dailyTuesday","name","dailyTuesday","id","dailyTuesday",1,"form-check-input","pr-2",3,"change"],["for","dailyTuesday",1,"form-label","pl-2"],["type","checkbox","formControlName","dailyWednesday","name","dailyWednesday","id","dailyWednesday",1,"form-check-input","pr-2",3,"change"],["for","dailyWednesday",1,"form-label","pl-2"],["type","checkbox","formControlName","dailyThursday","name","dailyThursday","id","dailyThursday",1,"form-check-input","pr-2",3,"change"],["for","dailyThursday",1,"form-label","pl-2"],["type","checkbox","formControlName","dailyFriday","name","dailyFriday","id","dailyFriday",1,"form-check-input","pr-2",3,"change"],["for","dailyFriday",1,"form-label","pl-2"],["type","checkbox","formControlName","dailySaturday","name","dailySaturday","id","dailySaturday",1,"form-check-input","pr-2",3,"change"],["for","dailySaturday",1,"form-label","pl-2"]],template:function(e,o){1&e&&(t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),t._UZ(4,"span",4),t.qZA()(),t.TgZ(5,"li",2)(6,"a",5),t._uU(7,"Contratos"),t.qZA()(),t.TgZ(8,"li",6),t._uU(9,"Registrar contrato"),t.qZA()()(),t.YNc(10,Qe,77,22,"div",7)),2&e&&(t.xp6(10),t.Q6J("ngIf",!o.loadingIndicator))},dependencies:[h.rH,y._Y,y.YN,y.Kr,y.Fj,y.Wl,y.EJ,y.JJ,y.JL,y.Q7,g.sg,g.O5,Xe._L,y.sg,y.u,g.JJ]}),n})();var ne=f(512),T=f(3627),G=f(2611),Je=f(9025),oe=f(6081),et=f(5497),ie=f(6550),X=f(1576);const tt=["searchInput"];function nt(n,i){1&n&&(t.TgZ(0,"mat-header-cell",28)(1,"span",29),t._uU(2,"Nombre completo"),t.qZA()())}function ot(n,i){if(1&n&&(t.TgZ(0,"mat-cell",28)(1,"span",30),t._uU(2),t.qZA()()),2&n){const e=i.$implicit;t.xp6(2),t.Oqu(e.fullname)}}function it(n,i){1&n&&t._UZ(0,"mat-header-row",31)}function at(n,i){1&n&&t._UZ(0,"mat-row",32)}let rt=(()=>{class n{constructor(e,o,a,r,c){var s=this;this.ngxUiLoaderService=e,this.clientsService=o,this.dataService=a,this.titleService=r,this.router=c,this.pagination={},this.totalElements=0,this.pageSizeOptions=Je.X.pageSizeOptions,this.displayedColumns=["fullname"],this.redirect=(l="")=>{this.router.navigate(""!==l?[`${l}`]:[I.f.routes.dash])},this.initPagination=()=>{this.pagination.offset=0,this.pagination.limit=this.defPagination,this.pagination.filter=""},this.dataLoad=(0,v.Z)(function*(){s.ngxUiLoaderService.startLoader("loader-02");try{const l=yield s.clientsService.findActives(s.pagination);l.data&&(s.dataSource=new T.by(l.data),s.totalElements=l.count,s.dataSource.sort=s.sort)}catch(l){s.dataService.errorHandling(l)}s.ngxUiLoaderService.stopLoader("loader-02")}),this.nextPage=l=>{const{pageSize:d,pageIndex:u}=l;this.dataService.setSelectedPagination(d),this.defPagination=this.dataService.getSelectedPagination(),this.pagination.offset=this.defPagination*u,this.pagination.limit=d,this.dataLoad()},this.searchElement=(l=!1)=>{try{this.pagination.filter=this.searchInput.nativeElement.value,l&&(this.paginator&&this.paginator.firstPage(),this.pagination.offset=0,this.dataLoad())}catch(d){this.dataService.errorHandling(d)}},this.createContractFromClient=l=>{},this.user=this.dataService.getLoggedUser(),(!this.dataService.getIsLoggedIn()||!this.user)&&(this.dataService.clearLoginData(),this.redirect(I.f.routes.login))}ngOnInit(){this.titleService.setTitle("SISTEMA IMPERIAL | Contratos activos"),this.defPagination=this.dataService.getSelectedPagination(),this.initPagination(),this.dataLoad()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(oe.LA),t.Y36(et.a),t.Y36(L.D),t.Y36(ie.Dx),t.Y36(h.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-contracts-list"]],viewQuery:function(e,o){if(1&e&&(t.Gf(ne.NW,7),t.Gf(G.YE,7),t.Gf(tt,5)),2&e){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first),t.iGM(a=t.CRH())&&(o.sort=a.first),t.iGM(a=t.CRH())&&(o.searchInput=a.first)}},decls:33,vars:7,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"d-flex","align-items-center","flex-wrap","text-nowrap"],[1,"input-group","me-2","mb-2"],["name","searchInput","placeholder","Buscar",1,"form-control",2,"border-top-left-radius","1rem !important","border-bottom-left-radius","1rem !important","margin-left","0.5em","margin-right","0.5em"],["searchInput",""],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"feather","icon-search"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"card-title"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","fullname"],["fxFlex","auto 1 100%",4,"matHeaderCellDef"],["fxFlex","auto 1 100%",4,"matCellDef"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSizeOptions","pageSize","page"],["paginator",""],["fxFlex","auto 1 100%"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","padding-left","10px","width","100%"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user"]],template:function(e,o){1&e&&(t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),t._UZ(4,"span",4),t.qZA()(),t.TgZ(5,"li",2),t._uU(6,"Contratos"),t.qZA(),t.TgZ(7,"li",5),t._uU(8,"Clientes activos"),t.qZA()()(),t.TgZ(9,"div",6)(10,"div",7)(11,"div",8),t._UZ(12,"input",9,10),t.TgZ(14,"button",11),t.NdJ("click",function(){return o.searchElement(!0)}),t._UZ(15,"span",12),t.qZA()()()(),t.TgZ(16,"div",6)(17,"div",13)(18,"div",14)(19,"div",15)(20,"h6",16),t._uU(21,"Lista de clientes activos"),t.qZA(),t.TgZ(22,"div",17)(23,"div",18)(24,"mat-table",19,20),t.ynx(26,21),t.YNc(27,nt,3,0,"mat-header-cell",22),t.YNc(28,ot,3,1,"mat-cell",23),t.BQk(),t.YNc(29,it,1,0,"mat-header-row",24),t.YNc(30,at,1,0,"mat-row",25),t.qZA()()(),t.TgZ(31,"mat-paginator",26,27),t.NdJ("page",function(r){return o.nextPage(r)}),t.qZA()()()()()),2&e&&(t.xp6(24),t.Q6J("dataSource",o.dataSource),t.xp6(5),t.Q6J("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky","true"),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("length",o.totalElements)("pageSizeOptions",o.pageSizeOptions)("pageSize",o.defPagination))},dependencies:[h.rH,G.YE,ne.NW,T.BZ,T.fO,T.as,T.w1,T.Dz,T.nj,T.ge,T.ev,T.XQ,T.Gk,X.yH],styles:[".loader[_ngcontent-%COMP%]{width:100%!important;height:100%!important;z-index:5001}"]}),n})();var st=f(2417),lt=f(5829);function ct(n,i){1&n&&t._UZ(0,"span",39)}function dt(n,i){if(1&n&&(t.TgZ(0,"div"),t._UZ(1,"hr"),t.TgZ(2,"div",6)(3,"div",32)(4,"p",40),t._uU(5," D\xedas expirados: "),t.TgZ(6,"span",12),t._uU(7),t.qZA()()()()()),2&n){const e=t.oxw().$implicit;t.xp6(7),t.Oqu(e.daysExpired)}}const ut=function(n){return{"background-color":n,color:"white"}},pt=function(n){return{color:n}};function ht(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"li",23),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.openDetails(r.clientId))}),t.TgZ(1,"div",24)(2,"div",25)(3,"span",26),t._UZ(4,"span",27),t.YNc(5,ct,1,0,"span",28),t._uU(6),t.qZA()(),t.TgZ(7,"div",17)(8,"div",6)(9,"div",29)(10,"p",30)(11,"b"),t._uU(12,"Contrato"),t.qZA()()(),t.TgZ(13,"div",29)(14,"p",30)(15,"b"),t._uU(16,"Total pagado"),t.qZA()()(),t.TgZ(17,"div",29)(18,"p",30)(19,"b"),t._uU(20,"Pendiente"),t.qZA()()()(),t.TgZ(21,"div",6)(22,"div",29)(23,"p",30),t._uU(24),t.ALo(25,"number"),t.qZA()(),t.TgZ(26,"div",29)(27,"p",30),t._uU(28),t.ALo(29,"number"),t.qZA()(),t.TgZ(30,"div",29)(31,"p",30),t._uU(32),t.ALo(33,"number"),t.qZA()()(),t._UZ(34,"hr"),t.TgZ(35,"div",6)(36,"div",31)(37,"p",30)(38,"b"),t._uU(39,"Pagos atrasados"),t.qZA()()(),t.TgZ(40,"div",31)(41,"p",30)(42,"b"),t._uU(43,"Pagos incompletos"),t.qZA()()()(),t.TgZ(44,"div",6)(45,"div",31)(46,"p",30),t._uU(47),t.qZA()(),t.TgZ(48,"div",31)(49,"p",30),t._uU(50),t.qZA()()(),t._UZ(51,"hr"),t.TgZ(52,"div",6)(53,"div",31)(54,"p",30)(55,"b"),t._uU(56,"Pagos al dia"),t.qZA()()(),t.TgZ(57,"div",31)(58,"p",30)(59,"b"),t._uU(60,"Pagos pendientes"),t.qZA()()()(),t.TgZ(61,"div",6)(62,"div",31)(63,"p",30),t._uU(64),t.qZA()(),t.TgZ(65,"div",31)(66,"p",30),t._uU(67),t.qZA()()(),t._UZ(68,"hr"),t.TgZ(69,"div",6)(70,"div",32)(71,"p",30)(72,"b"),t._uU(73,"Pagos adelantados"),t.qZA()()()(),t.TgZ(74,"div",6)(75,"div",32)(76,"p",30),t._uU(77),t.qZA()()(),t.YNc(78,dt,8,1,"div",33),t.qZA(),t.TgZ(79,"div",34)(80,"div",35)(81,"div")(82,"p",36)(83,"b"),t._uU(84,"Valor cuota"),t.qZA(),t._uU(85),t.ALo(86,"number"),t.qZA()(),t.TgZ(87,"div")(88,"p",37),t._UZ(89,"span",38),t.TgZ(90,"b"),t._uU(91),t.qZA()()()()()()()}if(2&n){const e=i.$implicit;t.xp6(2),t.Q6J("ngStyle",t.VKq(34,ut,""!==e.color?e.color:"black")),t.xp6(2),t.Gre("feather icon-",e.icon,""),t.Q6J("ngStyle",t.VKq(36,pt,e.incomplete>0?"orange":"white")),t.xp6(1),t.Q6J("ngIf",e.pendingPayments),t.xp6(1),t.hij(" \xa0\xa0",e.fullname," "),t.xp6(18),t.hij(" ",t.Dn7(25,18,e.loanAmount,"","es")," R$ "),t.xp6(4),t.hij(" ",t.Dn7(29,22,e.payed,"","es")," R$ "),t.xp6(4),t.hij(" ",t.Dn7(33,26,e.pending,"","es")," R$ "),t.xp6(15),t.hij(" ",e.late," "),t.xp6(3),t.hij(" ",e.incomplete," "),t.xp6(14),t.hij(" ",e.upToDate," "),t.xp6(3),t.hij(" ",e.remaining," "),t.xp6(10),t.hij(" ",e.daysAhead," "),t.xp6(1),t.Q6J("ngIf",e.daysExpired>0),t.xp6(7),t.hij(" ",t.Dn7(86,30,e.payment,"","es")," R$ "),t.xp6(6),t.hij(" ",e.phoneNumber,"")}}let mt=(()=>{class n{constructor(e,o,a,r,c){var s=this;this.ngxUiLoaderService=e,this.contractsService=o,this.dataService=a,this.titleService=r,this.router=c,this.totalUnpaid=0,this.totalPending=0,this.totalIncomplete=0,this.totalExpired=0,this.totalAhead=0,this.sourceData=[],this.displayedColumns=["fullname","amount","pending","payment","late","incomplete","upToDate","remaining"],this.redirect=(l="")=>{this.router.navigate(""!==l?[`${l}`]:[I.f.routes.dash])},this.dataLoad=(0,v.Z)(function*(){s.ngxUiLoaderService.startLoader("loader-02");try{const l=yield s.contractsService.getPendingPaymentContracts(),{data:d}=l;if(d){const{pendingArray:u,totalIncomplete:p,totalPending:m,totalExpired:_,totalUnpaid:x,totalAhead:H}=d;s.clients=u.map(b=>new st.T(b.client))||[],s.totalUnpaid=x,s.totalIncomplete=p,s.totalPending=m,s.totalExpired=_,s.totalAhead=H,u.forEach(b=>{s.sourceData.push({clientId:b.client.id,fullname:b.client.fullname,phoneNumber:b.client.phoneNumber,icon:b.contractData.icon,color:b.contractData.color,amount:b.contractData.amount,pending:b.contractData.pending,payment:b.contractData.payment,loanAmount:b.contractData.loanAmount,payed:b.contractData.payed,late:b.contractData.late,upToDate:b.contractData.upToDate,incomplete:b.contractData.incomplete,remaining:b.contractData.remaining,pendingPayments:b.contractData.pendingPayments,daysExpired:b.contractData.daysExpired,daysAhead:b.contractData.daysAhead})}),s.dataSource=new T.by(s.sourceData),s.dataSource.sort=s.sort}}catch(l){s.dataService.errorHandling(l)}s.ngxUiLoaderService.stopLoader("loader-02")}),this.refresh=(0,v.Z)(function*(){s.totalUnpaid=0,s.totalIncomplete=0,s.sourceData=[],yield s.dataLoad()}),this.openDetails=l=>{const d=this.clients.find(u=>u.id===l);this.dataService.setExistClient(d),this.redirect(I.f.routes.clientsDetail)},this.openResume=()=>{this.redirect(I.f.routes.movementsDailyResume)},this.user=this.dataService.getLoggedUser(),(!this.dataService.getIsLoggedIn()||!this.user)&&(this.dataService.clearLoginData(),this.redirect(I.f.routes.login))}ngOnInit(){(0,g.qS)(ee.Z),this.titleService.setTitle("SISTEMA IMPERIAL | Pendientes de pago"),this.dataLoad()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(oe.LA),t.Y36(te.W),t.Y36(L.D),t.Y36(ie.Dx),t.Y36(h.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-pending"]],viewQuery:function(e,o){if(1&e&&t.Gf(G.YE,7),2&e){let a;t.iGM(a=t.CRH())&&(o.sort=a.first)}},decls:54,vars:6,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"d-grid","gap-2"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[2,"color","green"],[2,"color","orange"],[2,"color","red"],["type","button",1,"btn","btn-primary","btn-icon-text",3,"click"],[1,"feather","icon-refresh-cw","btn-icon-append"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[2,"overflow-x","auto !important"],[1,"list-group",2,"max-width","87vw"],["class","list-group-item mb-2 p-0","style","max-width: 87vw;",3,"click",4,"ngFor","ngForOf"],[1,"row","p-2",2,"width","-webkit-fill-available","left","1em","right","1em"],["type","button",1,"btn","btn-primary",3,"click"],[1,"list-group-item","mb-2","p-0",2,"max-width","87vw",3,"click"],[1,"card"],[1,"card-header",3,"ngStyle"],[1,"card-title","mt-0"],[3,"ngStyle"],["class","feather icon-dollar-sign","style","color: green",4,"ngIf"],[1,"col-4",2,"padding","0 !important"],[2,"text-align","center"],[1,"col-6",2,"padding","0 !important"],[1,"col-12",2,"padding","0 !important"],[4,"ngIf"],[1,"card-footer"],["fxLayout","row","fxLayoutAlign","space-between"],[2,"text-align","left"],[2,"text-align","right"],[1,"feather","icon-phone"],[1,"feather","icon-dollar-sign",2,"color","green"],[2,"text-align","left","padding-left","12px"]],template:function(e,o){1&e&&(t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),t._UZ(4,"span",4),t.qZA()(),t.TgZ(5,"li",2),t._uU(6,"Contratos"),t.qZA(),t.TgZ(7,"li",5),t._uU(8,"Pendientes de pago"),t.qZA()()(),t.TgZ(9,"div",6)(10,"div",7)(11,"ul",8)(12,"li",9),t._uU(13,"Hay "),t.TgZ(14,"span",10),t._uU(15),t.qZA(),t._uU(16," clientes con pagos adelantados"),t.qZA(),t.TgZ(17,"li",9),t._uU(18,"Hay "),t.TgZ(19,"span",10),t._uU(20),t.qZA(),t._uU(21," clientes con pagos por validar"),t.qZA(),t.TgZ(22,"li",9),t._uU(23,"Hay "),t.TgZ(24,"span",11),t._uU(25),t.qZA(),t._uU(26," clientes con pago incompleto"),t.qZA(),t.TgZ(27,"li",9),t._uU(28,"Hay "),t.TgZ(29,"span",12),t._uU(30),t.qZA(),t._uU(31," clientes con pagos atrasados"),t.qZA(),t.TgZ(32,"li",9),t._uU(33,"Hay "),t.TgZ(34,"span",12),t._uU(35),t.qZA(),t._uU(36," clientes con pagos expirados"),t.qZA()()()(),t._UZ(37,"br"),t.TgZ(38,"div",6)(39,"div",7)(40,"button",13),t.NdJ("click",function(){return o.refresh()}),t._uU(41," Actualizar "),t._UZ(42,"span",14),t.qZA()()(),t.TgZ(43,"div",6)(44,"div",15)(45,"div",16)(46,"div",17)(47,"div",18)(48,"ul",19),t.YNc(49,ht,92,38,"li",20),t.qZA()()()()()(),t.TgZ(50,"div",21)(51,"button",22),t.NdJ("click",function(){return o.openResume()}),t.TgZ(52,"span"),t._uU(53,"Resumen del dia"),t.qZA()()()),2&e&&(t.xp6(15),t.Oqu(o.totalAhead),t.xp6(5),t.Oqu(o.totalPending),t.xp6(5),t.Oqu(o.totalIncomplete),t.xp6(5),t.Oqu(o.totalUnpaid),t.xp6(5),t.Oqu(o.totalExpired),t.xp6(14),t.Q6J("ngForOf",o.sourceData))},dependencies:[h.rH,g.sg,g.O5,g.PC,X.xw,X.Wh,lt.Zl,g.JJ]}),n})();var gt=f(6356);const ft=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:rt},{path:"create",component:Ke},{path:"pending",component:mt}];let yt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[h.Bz.forChild(ft),y.u5,gt.A,y.UX]}),n})()},8405:(z,R,f)=>{f.d(R,{W:()=>F});var h=f(5861),y=f(7066),v=f(2223),g=f(3144);let F=(()=>{class C extends y.D{constructor(S){var w;super(),w=this,this.http=S,this.createContract=function(){var D=(0,h.Z)(function*(P){return w.http.post(`${w.getApiUrl()}/contracts`,{...P},{headers:w.getHeaders()}).toPromise()});return function(P){return D.apply(this,arguments)}}(),this.cancelContract=function(){var D=(0,h.Z)(function*(P){return w.http.post(`${w.getApiUrl()}/contracts/cancel-contract`,{id:P},{headers:w.getHeaders()}).toPromise()});return function(P){return D.apply(this,arguments)}}(),this.loadContractData=(0,h.Z)(function*(D="undefined"){return w.http.get(`${w.getApiUrl()}/contracts/user/${D}`,{headers:w.getHeaders()}).toPromise()}),this.recalculateContractData=(0,h.Z)(function*(D="undefined"){return w.http.get(`${w.getApiUrl()}/contracts/recalculate/user/${D}`,{headers:w.getHeaders()}).toPromise()}),this.getPendingPaymentContracts=(0,h.Z)(function*(D=null){return w.http.get(`${w.getApiUrl()}/contracts/pending`,{headers:w.getHeaders()}).toPromise()}),this.contractsFromToday=(0,h.Z)(function*(){return w.http.get(`${w.getApiUrl()}/contracts/from-today`,{headers:w.getHeaders()}).toPromise()}),this.loadModalities=(0,h.Z)(function*(){return w.http.get(`${w.getApiUrl()}/modalities`,{headers:w.getHeaders()}).toPromise()})}}return C.\u0275fac=function(S){return new(S||C)(v.Y36(g.eN))},C.\u0275dir=v.lG2({type:C,features:[v.qOj]}),C.\u0275prov=v.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})()},2417:(z,R,f)=>{f.d(R,{T:()=>y});const h=v=>v.charAt(0).toUpperCase()+v.slice(1);class y{constructor(g){this.getFullName=()=>`${h(this.firstName)} ${h(this.paternalSurname)}`,this.id=g.id||"",this.icon=g.icon||"",this.color=g.color||"",this.permission=g.permission||"",this.cpf=g.cpf||"",this.email=g.email||"",this.isLogged=g.isLogged||!1,this.role=g.role||"",this.gender=g.gender||"",this.fullname=g.fullname||"",this.firstName=g.firstName||"",this.secondName=g.secondName||"",this.paternalSurname=g.paternalSurname||"",this.maternalSurname=g.maternalSurname||"",this.birthDate=g.birthDate||"",this.profilePicture=g.profilePicture||"",this.addressPicture=g.addressPicture||"",this.residenceAddress=g.residenceAddress||"",this.billingAddress=g.billingAddress||"",this.phoneNumber=g.phoneNumber||"",this.points=g.points||0}}},7228:(z,R,f)=>{f.d(R,{Z:()=>v});const h=void 0,v=["es",[["a.\xa0m.","p.\xa0m."],h,h],h,[["D","L","M","X","J","V","S"],["dom","lun","mar","mi\xe9","jue","vie","s\xe1b"],["domingo","lunes","martes","mi\xe9rcoles","jueves","viernes","s\xe1bado"],["DO","LU","MA","MI","JU","VI","SA"]],h,[["E","F","M","A","M","J","J","A","S","O","N","D"],["ene","feb","mar","abr","may","jun","jul","ago","sept","oct","nov","dic"],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]],h,[["a. C.","d. C."],h,["antes de Cristo","despu\xe9s de Cristo"]],1,[6,0],["d/M/yy","d MMM y","d 'de' MMMM 'de' y","EEEE, d 'de' MMMM 'de' y"],["H:mm","H:mm:ss","H:mm:ss z","H:mm:ss (zzzz)"],["{1}, {0}",h,h,h],[",",".",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{AUD:[h,"$"],BRL:[h,"R$"],BYN:[h,"\u0440."],CAD:[h,"$"],CNY:[h,"\xa5"],EGP:[],ESP:["\u20a7"],GBP:[h,"\xa3"],HKD:[h,"$"],ILS:[h,"\u20aa"],INR:[h,"\u20b9"],JPY:[h,"\xa5"],KRW:[h,"\u20a9"],MXN:[h,"$"],NZD:[h,"$"],PHP:[h,"\u20b1"],RON:[h,"L"],THB:["\u0e3f"],TWD:[h,"NT$"],USD:["US$","$"],XAF:[],XCD:[h,"$"],XOF:[]},"ltr",function y(g){const F=g,C=Math.floor(Math.abs(g)),B=g.toString().replace(/^[^.]*\.?/,"").length,S=parseInt(g.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 1===F?1:0===S&&0!==C&&C%1e6==0&&0===B||!(S>=0&&S<=5)?4:5}]}}]);