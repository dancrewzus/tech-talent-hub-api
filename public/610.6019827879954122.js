"use strict";(self.webpackChunkimperial=self.webpackChunkimperial||[]).push([[610],{6610:(se,A,i)=>{i.r(A),i.d(A,{MovementsModule:()=>oe});var y=i(9562),l=i(5030),g=i(5861),S=i(5226),Z=i.n(S),I=i(6811),_=i(2534),e=i(2223),D=i(6081),x=i(7066),Y=i(3144);let U=(()=>{class t extends x.D{constructor(a){var o;super(),o=this,this.http=a,this.createMovement=function(){var m=(0,g.Z)(function*(c){return o.http.post(`${o.getApiUrl()}/movements`,{...c},{headers:o.getHeaders()}).toPromise()});return function(c){return m.apply(this,arguments)}}(),this.updateUser=function(){var m=(0,g.Z)(function*(c,v){return o.http.patch(`${o.getApiUrl()}/movements/${c}`,{...v},{headers:o.getHeaders()}).toPromise()});return function(c,v){return m.apply(this,arguments)}}(),this.dailyResume=(0,g.Z)(function*(){return o.http.get(`${o.getApiUrl()}/movements/daily-resume`,{headers:o.getHeaders()}).toPromise()})}}return t.\u0275fac=function(a){return new(a||t)(e.Y36(Y.eN))},t.\u0275dir=e.lG2({type:t,features:[e.qOj]}),t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var q=i(4074),M=i(5580),R=i(6550),b=i(4755);function w(t,n){if(1&t){const a=e.EpF();e.TgZ(0,"div",30)(1,"img",31),e.NdJ("click",function(){e.CHM(a);const m=e.oxw();return e.KtG(m.openImage("payment"))}),e.qZA()()}if(2&t){const a=e.oxw();e.xp6(1),e.Q6J("src",a.paymentImage,e.LSH)}}let F=(()=>{class t{constructor(a,o,m,c,v,r,s,C,T){var u=this;this.ngxUiLoaderService=a,this.movementsService=o,this.imagesService=m,this.dataService=c,this.formBuilder=v,this.matDialog=r,this.titleService=s,this.location=C,this.router=T,this.paymentImage=null,this.createForm=()=>this.formBuilder.group({type:["",l.kI.required],amount:["",l.kI.required],description:["",l.kI.required]}),this.redirect=(f="")=>{this.router.navigate(""!==f?[`${f}`]:[_.f.routes.dash])},this.createPayment=function(){var f=(0,g.Z)(function*(h){u.ngxUiLoaderService.startLoader("loader-02");try{h.preventDefault();let p=null;u.paymentImage&&(p=yield u.imagesService.createImage({base64:u.paymentImage,type:"payment"}));const ie=u.elementForm.getRawValue(),{type:re,amount:le,description:me}=ie;yield u.movementsService.createMovement({type:re,amount:le,description:me,paymentPicture:p?.id||""}),u.redirect(_.f.routes.dash)}catch(p){u.dataService.errorHandling(p)}finally{u.ngxUiLoaderService.stopLoader("loader-02")}});return function(h){return f.apply(this,arguments)}}(),this.openImage=f=>{let h="",p="";"payment"===f&&(h="pagamento",p=this.paymentImage),Z().fire({title:`<strong>Imagem do ${h}</strong>`,html:`<div class="card"><div class="card-body"><img src="${p}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Fechar",confirmButtonAriaLabel:"close"})},this.openCamera=f=>{this.cameraDialogRef=this.matDialog.open(I.M,{autoFocus:!0,disableClose:!0,height:"90vh",minWidth:"95vw"}),this.cameraDialogRef.afterClosed().subscribe(function(){var h=(0,g.Z)(function*(p){p&&"payment"===f&&(u.paymentImage=p),u.cameraDialogRef=null});return function(p){return h.apply(this,arguments)}}())},this.dataService.clearCreatedUser()}ngOnInit(){this.titleService.setTitle("IMPERIAL | Registrar movimento"),this.elementForm=this.createForm()}}return t.\u0275fac=function(a){return new(a||t)(e.Y36(D.LA),e.Y36(U),e.Y36(q.C),e.Y36(x.D),e.Y36(l.qu),e.Y36(M.uw),e.Y36(R.Dx),e.Y36(b.Ye),e.Y36(y.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create"]],decls:45,vars:4,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],["name","elementForm","novalidate","",3,"formGroup"],[1,"mb-3"],["for","type",1,"form-label"],["id","type","formControlName","type","required","",1,"form-select"],["value","in","selected",""],["value","out"],["for","amount",1,"form-label"],["type","text","id","amount","name","amount","appInputRestriction","float","formControlName","amount","oninput","this.value=this.value.replace(/[^0-9]/g,'')","required","",1,"form-control",2,"text-align","right","padding-right","1em"],["for","description",1,"form-label"],["id","description","formControlName","description","autocomplete","off","required","",1,"form-control"],[1,"row","mb-3"],["class","col-12","style","text-align: center",4,"ngIf"],[1,"col-12"],[1,"d-grid","gap-2"],["href","","href","javascript:void(0)",1,"btn","btn-primary",3,"click"],[1,"feather","icon-camera"],[2,"text-align","center"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled","click"],[1,"btn","btn-secondary",3,"routerLink","click"],[1,"col-12",2,"text-align","center"],["alt","...",1,"card-img-top",3,"src","click"]],template:function(a,o){1&a&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimentos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Registrar"),e.qZA()()(),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"h6",10),e._uU(14,"Registrar"),e.qZA(),e.TgZ(15,"form",11)(16,"div",12)(17,"label",13),e._uU(18,"Forma"),e.qZA(),e.TgZ(19,"select",14)(20,"option",15),e._uU(21,"Receita"),e.qZA(),e.TgZ(22,"option",16),e._uU(23,"Despesa"),e.qZA()()(),e.TgZ(24,"div",12)(25,"label",17),e._uU(26,"Quantia"),e.qZA(),e._UZ(27,"input",18),e.qZA(),e.TgZ(28,"div",12)(29,"label",19),e._uU(30,"Descri\xe7\xe3o"),e.qZA(),e._UZ(31,"textarea",20),e.qZA(),e.TgZ(32,"div",21),e.YNc(33,w,2,1,"div",22),e.qZA(),e.TgZ(34,"div",21)(35,"div",23)(36,"div",24)(37,"a",25),e.NdJ("click",function(){return o.openCamera("payment")}),e._UZ(38,"span",26),e.qZA()()()(),e._UZ(39,"hr"),e.TgZ(40,"div",27)(41,"button",28),e.NdJ("click",function(c){return o.createPayment(c)}),e._uU(42,"Aceitar"),e.qZA(),e.TgZ(43,"button",29),e.NdJ("click",function(){return!1}),e._uU(44,"Cancelar"),e.qZA()()()()()()()),2&a&&(e.xp6(15),e.Q6J("formGroup",o.elementForm),e.xp6(18),e.Q6J("ngIf",o.paymentImage),e.xp6(8),e.Q6J("disabled",o.elementForm.invalid),e.xp6(2),e.Q6J("routerLink","/admin/dashboard"))},dependencies:[y.rH,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.Q7,b.O5,l.sg,l.u]}),t})();var N=i(6356),d=i(3627),L=i(2611),J=i(1576);function k(t,n){1&t&&(e.TgZ(0,"mat-header-cell",29)(1,"span",30),e._uU(2,"Descri\xe7\xe3o"),e.qZA()())}function B(t,n){if(1&t&&(e.TgZ(0,"mat-cell",29)(1,"span",31),e._uU(2),e.qZA()()),2&t){const a=n.$implicit;e.xp6(2),e.Oqu(a.description)}}function Q(t,n){1&t&&(e.TgZ(0,"mat-header-cell",32)(1,"span",30),e._uU(2,"Receitas"),e.qZA()())}function H(t,n){if(1&t&&(e.TgZ(0,"span",34),e._uU(1),e.qZA()),2&t){const a=e.oxw().$implicit;e.xp6(1),e.Oqu(a.amount)}}function $(t,n){1&t&&(e.TgZ(0,"span",34),e._uU(1,"0"),e.qZA())}function P(t,n){if(1&t&&(e.TgZ(0,"mat-cell",32),e.YNc(1,H,2,1,"span",33),e.YNc(2,$,2,0,"span",33),e.qZA()),2&t){const a=n.$implicit;e.xp6(1),e.Q6J("ngIf","in"===a.type),e.xp6(1),e.Q6J("ngIf","in"!==a.type)}}function E(t,n){1&t&&(e.TgZ(0,"mat-header-cell",32)(1,"span",30),e._uU(2,"Despesas"),e.qZA()())}function O(t,n){if(1&t&&(e.TgZ(0,"span",34),e._uU(1),e.qZA()),2&t){const a=e.oxw().$implicit;e.xp6(1),e.hij("-",a.amount,"")}}function j(t,n){1&t&&(e.TgZ(0,"span",34),e._uU(1,"0"),e.qZA())}function G(t,n){if(1&t&&(e.TgZ(0,"mat-cell",32),e.YNc(1,O,2,1,"span",33),e.YNc(2,j,2,0,"span",33),e.qZA()),2&t){const a=n.$implicit;e.xp6(1),e.Q6J("ngIf","out"===a.type),e.xp6(1),e.Q6J("ngIf","out"!==a.type)}}function z(t,n){1&t&&(e.TgZ(0,"mat-header-cell",32)(1,"span",30),e._uU(2,"Imagem"),e.qZA()())}function K(t,n){if(1&t){const a=e.EpF();e.TgZ(0,"span",34)(1,"a",35),e.NdJ("click",function(){e.CHM(a);const m=e.oxw().$implicit,c=e.oxw();return e.KtG(c.openImage(m.paymentPicture))}),e._UZ(2,"span",36),e.qZA()()}}function X(t,n){1&t&&e._UZ(0,"span",34)}function V(t,n){if(1&t&&(e.TgZ(0,"mat-cell",32),e.YNc(1,K,3,0,"span",33),e.YNc(2,X,1,0,"span",33),e.qZA()),2&t){const a=n.$implicit;e.xp6(1),e.Q6J("ngIf",a.paymentPicture),e.xp6(1),e.Q6J("ngIf",!a.paymentPicture)}}function W(t,n){1&t&&e._UZ(0,"mat-header-row",37)}function ee(t,n){1&t&&e._UZ(0,"mat-row",38)}function te(t,n){if(1&t){const a=e.EpF();e.TgZ(0,"button",39),e.NdJ("click",function(){e.CHM(a);const m=e.oxw();return e.KtG(m.blockDailyResume())}),e.TgZ(1,"span"),e._uU(2,"Bloquear"),e.qZA()()}}function ae(t,n){1&t&&(e.TgZ(0,"button",40)(1,"span"),e._uU(2,"Bloqueado"),e.qZA()())}const ne=[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:F},{path:"daily-resume",component:(()=>{class t{constructor(a,o,m,c,v){var r=this;this.ngxUiLoaderService=a,this.movementsService=o,this.dataService=m,this.titleService=c,this.router=v,this.yesterdayAmount=0,this.todayAmount=0,this.movementsFromToday=[],this.closed=!1,this.displayedColumns=["details","incomes","expenses","image"],this.redirect=(s="")=>{this.router.navigate(""!==s?[`${s}`]:[_.f.routes.dash])},this.loadData=(0,g.Z)(function*(){r.ngxUiLoaderService.startLoader("loader-02");try{const s=yield r.movementsService.dailyResume();if(s){const{yesterdayAmount:C,todayAmount:T,movementsFromToday:u,closed:f}=s;r.yesterdayAmount=C,r.todayAmount=T,r.closed=f,r.dataSource=new d.by(u)}}catch(s){r.dataService.errorHandling(s)}finally{r.ngxUiLoaderService.stopLoader("loader-02")}}),this.blockDailyResume=(0,g.Z)(function*(){Z().fire({title:"Tem certeza?",text:"Essa a\xe7\xe3o n\xe3o pode ser desfeita!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, bloquear!",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&r.createFinalMovement()})}),this.createFinalMovement=(0,g.Z)(function*(){try{r.ngxUiLoaderService.startLoader("loader-02"),yield r.movementsService.createMovement({amount:r.todayAmount,type:"final",description:"Feche do caixa",paymentPicture:""}),r.redirect(_.f.routes.dash)}catch(s){r.dataService.errorHandling(s)}finally{r.ngxUiLoaderService.stopLoader("loader-02")}}),this.openImage=s=>{Z().fire({title:"<strong>Imagem</strong>",html:`<div class="card"><div class="card-body"><img src="${s}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Fechar",confirmButtonAriaLabel:"close"})},this.user=this.dataService.getLoggedUser(),(!this.dataService.getIsLoggedIn()||!this.user)&&(this.dataService.clearLoginData(),this.redirect(_.f.routes.login))}ngOnInit(){this.titleService.setTitle("IMPERIAL | Resumo do dia"),this.loadData()}}return t.\u0275fac=function(a){return new(a||t)(e.Y36(D.LA),e.Y36(U),e.Y36(x.D),e.Y36(R.Dx),e.Y36(y.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-daily-resume"]],decls:50,vars:8,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"card-title"],[1,"mb-3"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","details"],["fxFlex","auto 1 150px",4,"matHeaderCellDef"],["fxFlex","auto 1 150px",4,"matCellDef"],["matColumnDef","incomes"],["fxFlex","auto 1 100px",4,"matHeaderCellDef"],["fxFlex","auto 1 100px",4,"matCellDef"],["matColumnDef","expenses"],["matColumnDef","image"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",4,"matRowDef","matRowDefColumns"],[1,"row","p-2","mt-4",2,"position","sticky","width","-webkit-fill-available","bottom","4em","left","1em","right","1em"],["class","btn btn-primary","type","button",3,"click",4,"ngIf"],["class","btn btn-primary","type","button","disabled","",4,"ngIf"],["fxFlex","auto 1 150px"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","width","100%"],["fxFlex","auto 1 100px"],["style","margin: 0; text-align: right; width: 100%;",4,"ngIf"],[2,"margin","0","text-align","right","width","100%"],["href","","href","javascript:void(0)",1,"btn","btn-primary",3,"click"],[1,"feather","icon-image"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user"],["type","button",1,"btn","btn-primary",3,"click"],["type","button","disabled","",1,"btn","btn-primary"]],template:function(a,o){1&a&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimentos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Resumo do dia"),e.qZA()()(),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"h6",10),e._uU(14,"Resumo do dia"),e.qZA(),e.TgZ(15,"div",11)(16,"span")(17,"b"),e._uU(18,"Saldo anterior:"),e.qZA(),e._uU(19),e.qZA(),e._UZ(20,"br"),e.qZA(),e.TgZ(21,"div",12)(22,"div",13)(23,"mat-table",14,15),e.ynx(25,16),e.YNc(26,k,3,0,"mat-header-cell",17),e.YNc(27,B,3,1,"mat-cell",18),e.BQk(),e.ynx(28,19),e.YNc(29,Q,3,0,"mat-header-cell",20),e.YNc(30,P,3,2,"mat-cell",21),e.BQk(),e.ynx(31,22),e.YNc(32,E,3,0,"mat-header-cell",20),e.YNc(33,G,3,2,"mat-cell",21),e.BQk(),e.ynx(34,23),e.YNc(35,z,3,0,"mat-header-cell",20),e.YNc(36,V,3,2,"mat-cell",21),e.BQk(),e.YNc(37,W,1,0,"mat-header-row",24),e.YNc(38,ee,1,0,"mat-row",25),e.qZA()()(),e._UZ(39,"br")(40,"br"),e.TgZ(41,"div",11)(42,"span")(43,"b"),e._uU(44,"Saldo do dia:"),e.qZA(),e._uU(45),e.qZA(),e._UZ(46,"br"),e.qZA()()()()(),e.TgZ(47,"div",26),e.YNc(48,te,3,0,"button",27),e.YNc(49,ae,3,0,"button",28),e.qZA()),2&a&&(e.xp6(19),e.hij(" ",o.yesterdayAmount,""),e.xp6(4),e.Q6J("dataSource",o.dataSource),e.xp6(14),e.Q6J("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(7),e.hij(" ",o.todayAmount,""),e.xp6(3),e.Q6J("ngIf",!o.closed),e.xp6(1),e.Q6J("ngIf",o.closed))},dependencies:[y.rH,b.O5,L.YE,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,J.yH],styles:[".ngx-datatable[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]{display:none!important}"]}),t})()}];let oe=(()=>{class t{}return t.\u0275fac=function(a){return new(a||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[y.Bz.forChild(ne),l.u5,N.A,l.UX]}),t})()}}]);