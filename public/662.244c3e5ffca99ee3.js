"use strict";(self.webpackChunkimperial=self.webpackChunkimperial||[]).push([[662],{5662:(Ct,L,u)=>{u.r(L),u.d(L,{MovementsModule:()=>pt});var C=u(9562),m=u(5030),h=u(5861),x=u(4755),S=u(7228),Q=u(5226),Z=u.n(Q),y=u(2534),c=u(3627),e=u(2223),U=u(6081),D=u(7760),w=u(7066),F=u(6550),R=u(2611),M=u(1576),N=u(9089);function H(t,a){1&t&&(e.TgZ(0,"mat-header-cell",34)(1,"span",35),e._uU(2,"Descripci\xf3n"),e.qZA()())}function $(t,a){if(1&t&&(e.TgZ(0,"mat-cell",34)(1,"span",36),e._uU(2),e._UZ(3,"br"),e._uU(4),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij(" ",n.description,""),e.xp6(2),e.hij(" ",n.createdAt," ")}}function E(t,a){1&t&&(e.TgZ(0,"mat-header-cell",37)(1,"span",35),e._uU(2,"Ingresos"),e.qZA()())}function V(t,a){if(1&t&&(e.TgZ(0,"mat-cell",37)(1,"span",38),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.amount,"","es")," R$")}}function j(t,a){1&t&&(e.TgZ(0,"mat-header-cell",39)(1,"span",35),e._uU(2,"Imagen"),e.qZA()())}function O(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"span",35)(1,"button",41),e.NdJ("click",function(){e.CHM(n);const p=e.oxw().$implicit,d=e.oxw();return e.KtG(d.openImage(p.paymentPicture))}),e._UZ(2,"span",42),e.qZA()()}}function G(t,a){1&t&&e._UZ(0,"span",35)}function K(t,a){if(1&t&&(e.TgZ(0,"mat-cell",39),e.YNc(1,O,3,0,"span",40),e.YNc(2,G,1,0,"span",40),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Q6J("ngIf",n.paymentPicture),e.xp6(1),e.Q6J("ngIf",!n.paymentPicture)}}function W(t,a){1&t&&(e.TgZ(0,"mat-header-cell",43)(1,"span",35),e._uU(2,"Opciones"),e.qZA()())}function z(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"mat-cell",43)(1,"div",44)(2,"button",45),e.NdJ("click",function(){const d=e.CHM(n).$implicit,v=e.oxw();return e.KtG(v.validatePayment(d,"validate"))}),e._UZ(3,"span",46),e.qZA(),e.TgZ(4,"button",47),e.NdJ("click",function(){const d=e.CHM(n).$implicit,v=e.oxw();return e.KtG(v.validatePayment(d,"cancel"))}),e._UZ(5,"span",48),e.qZA()()()}}function X(t,a){1&t&&e._UZ(0,"mat-header-row",49)}function ee(t,a){1&t&&e._UZ(0,"mat-row",50)}let te=(()=>{class t{constructor(n,i,p,d,v){var g=this;this.ngxUiLoaderService=n,this.movementsService=i,this.dataService=p,this.titleService=d,this.router=v,this.yesterdayAmount=0,this.todayAmount=0,this.movementsFromToday=[],this.closed=!1,this.displayedColumns=["details","amount","image","options"],this.redirect=(r="")=>{this.router.navigate(""!==r?[`${r}`]:[y.f.routes.dash])},this.loadData=(0,h.Z)(function*(){g.ngxUiLoaderService.startLoader("loader-02");try{const r=yield g.movementsService.movementsPending();if(r){const{data:l,todayAmount:o}=r;g.todayAmount=o,g.dataSource=new c.by(l)}}catch(r){g.dataService.errorHandling(r)}finally{g.ngxUiLoaderService.stopLoader("loader-02")}}),this.validatePayment=function(){var r=(0,h.Z)(function*(l,o){Z().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"validate"===o?"Validar":"Anular",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&g.sendPayment(l,o)})});return function(l,o){return r.apply(this,arguments)}}(),this.sendPayment=function(){var r=(0,h.Z)(function*(l,o){try{switch(g.ngxUiLoaderService.startLoader("loader-02"),o){case"validate":yield g.movementsService.validateMovement({id:l.id,amount:l.amount});break;case"cancel":yield g.movementsService.cancelMovement(l.id)}window.location.reload()}catch(s){g.dataService.errorHandling(s)}finally{g.ngxUiLoaderService.stopLoader("loader-02")}});return function(l,o){return r.apply(this,arguments)}}(),this.editPayment=function(){var r=(0,h.Z)(function*(l){const o=g.dataSource.data[l],{value:s}=yield Z().fire({imageUrl:o.paymentPicture,title:"Editar pago reportado",input:"number",inputLabel:"Ingresa el nuevo monto",showCancelButton:!0,confirmButtonText:"Editar",cancelButtonText:"Cerrar",inputAttributes:{style:"color: white; text-align: right;"}});o.amount=s,g.dataSource.data[l]=o;let _=0;g.dataSource.data.forEach(f=>{console.log("\u{1f680} ~ file: payments-pending.component.ts:149 ~ ValidationPaymentsPendingComponent ~ this.dataSource.data.forEach ~ payment:",f),_+=Number.parseInt(f.amount)}),console.log("\u{1f680} ~ file: payments-pending.component.ts:151 ~ ValidationPaymentsPendingComponent ~ this.dataSource.data.forEach ~ newAmount:",_),g.todayAmount=_});return function(l){return r.apply(this,arguments)}}(),this.openImage=r=>{Z().fire({title:"<strong>Imagen</strong>",html:`<div class="card"><div class="card-body"><img src="${r}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Cerrar",confirmButtonAriaLabel:"close"})},this.user=this.dataService.getLoggedUser(),(!this.dataService.getIsLoggedIn()||!this.user)&&(this.dataService.clearLoginData(),this.redirect(y.f.routes.login))}ngOnInit(){(0,x.qS)(S.Z),this.titleService.setTitle("IMPERIAL | Pagos pendientes por validar"),this.loadData()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(U.LA),e.Y36(D.M),e.Y36(w.D),e.Y36(F.Dx),e.Y36(C.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-payments-pending"]],decls:44,vars:9,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"card-title"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","details"],["fxFlex","auto 1 200px",4,"matHeaderCellDef"],["fxFlex","auto 1 200px",4,"matCellDef"],["matColumnDef","amount"],["fxFlex","auto 1",4,"matHeaderCellDef"],["fxFlex","auto 1",4,"matCellDef"],["matColumnDef","image"],["fxFlex","auto 1 100px",4,"matHeaderCellDef"],["fxFlex","auto 1 100px",4,"matCellDef"],["matColumnDef","options"],["fxFlex","auto 1 170px",4,"matHeaderCellDef"],["fxFlex","auto 1 170px",4,"matCellDef"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",4,"matRowDef","matRowDefColumns"],[1,"mb-3"],["for","paymentAmount",1,"form-label"],[1,"input-group"],["placement","bottom","ngbTooltip","Tooltip on bottom",1,"input-group-text","hover"],["disabled","","type","number","id","paymentAmount","autocomplete","off","required","",1,"form-control",2,"text-align","right",3,"value"],["fxFlex","auto 1 200px"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","width","100%"],["fxFlex","auto 1"],[2,"margin","0","text-align","right","width","100%"],["fxFlex","auto 1 100px"],["style","margin: 0; text-align: center; width: 100%;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"feather","icon-image"],["fxFlex","auto 1 170px"],["role","group",1,"btn-group",2,"margin","0","text-align","center","width","100%"],["type","button",1,"btn","btn-green",3,"click"],[1,"feather","icon-check"],["type","button",1,"btn","btn-red",2,"margin","0 6px",3,"click"],[1,"feather","icon-x"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user"]],template:function(n,i){1&n&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimientos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Pagos pendientes por validar"),e.qZA()()(),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"h6",10),e._uU(14,"Pagos pendientes por validar"),e.qZA(),e.TgZ(15,"div",11)(16,"div",12)(17,"mat-table",13,14),e.ynx(19,15),e.YNc(20,H,3,0,"mat-header-cell",16),e.YNc(21,$,5,2,"mat-cell",17),e.BQk(),e.ynx(22,18),e.YNc(23,E,3,0,"mat-header-cell",19),e.YNc(24,V,4,5,"mat-cell",20),e.BQk(),e.ynx(25,21),e.YNc(26,j,3,0,"mat-header-cell",22),e.YNc(27,K,3,2,"mat-cell",23),e.BQk(),e.ynx(28,24),e.YNc(29,W,3,0,"mat-header-cell",25),e.YNc(30,z,6,0,"mat-cell",26),e.BQk(),e.YNc(31,X,1,0,"mat-header-row",27),e.YNc(32,ee,1,0,"mat-row",28),e.qZA()()(),e._UZ(33,"br")(34,"br"),e.TgZ(35,"div",29)(36,"label",30)(37,"b"),e._uU(38,"Monto pendiente por validar"),e.qZA()(),e.TgZ(39,"div",31)(40,"span",32),e._uU(41,"R$"),e.qZA(),e._UZ(42,"input",33),e.ALo(43,"number"),e.qZA()()()()()()),2&n&&(e.xp6(17),e.Q6J("dataSource",i.dataSource),e.xp6(14),e.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumns),e.xp6(10),e.s9C("value",e.Dn7(43,5,i.todayAmount,"","es")))},dependencies:[C.rH,x.O5,R.YE,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,M.yH,N._L,x.JJ],styles:[".ngx-datatable[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]{display:none!important}"]}),t})();var ne=u(274),ae=u(1545),oe=u(5268),T=u(1764);function ie(t,a){if(1&t&&(e.TgZ(0,"option",38),e._uU(1),e.qZA()),2&t){const n=a.$implicit;e.s9C("value",n.id),e.xp6(1),e.Oqu(n.fullname)}}function re(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div"),e._UZ(1,"hr"),e.TgZ(2,"div",31)(3,"label",34),e._uU(4,"Seleccione trabajador"),e.qZA(),e.TgZ(5,"select",35),e.NdJ("change",function(p){e.CHM(n);const d=e.oxw();return e.KtG(d.changeWorker(p))}),e.TgZ(6,"option",36),e._uU(7,"General"),e.qZA(),e.YNc(8,ie,2,2,"option",37),e.qZA()()()}if(2&t){const n=e.oxw();e.xp6(8),e.Q6J("ngForOf",n.workers)}}function le(t,a){1&t&&(e.TgZ(0,"mat-header-cell",39)(1,"span",40),e._uU(2,"Descripci\xf3n"),e.qZA()())}function me(t,a){if(1&t&&(e.TgZ(0,"mat-cell",39)(1,"span",41),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.description)}}function ce(t,a){1&t&&(e.TgZ(0,"mat-header-cell",42)(1,"span",40),e._uU(2,"Ingresos"),e.qZA()())}function se(t,a){if(1&t&&(e.TgZ(0,"mat-cell",42)(1,"span",43),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.amount,"","es")," R$")}}function de(t,a){1&t&&(e.TgZ(0,"mat-header-cell",44)(1,"span",40),e._uU(2,"Imagen"),e.qZA()())}function ue(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"span",40)(1,"button",46),e.NdJ("click",function(){e.CHM(n);const p=e.oxw().$implicit,d=e.oxw();return e.KtG(d.openImage(p.paymentPicture))}),e._UZ(2,"span",47),e.qZA()()}}function pe(t,a){1&t&&e._UZ(0,"span",40)}function _e(t,a){if(1&t&&(e.TgZ(0,"mat-cell",44),e.YNc(1,ue,3,0,"span",45),e.YNc(2,pe,1,0,"span",45),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Q6J("ngIf",n.paymentPicture),e.xp6(1),e.Q6J("ngIf",!n.paymentPicture)}}function fe(t,a){1&t&&e._UZ(0,"mat-header-row",48)}function ge(t,a){1&t&&e._UZ(0,"mat-row",49)}function ve(t,a){1&t&&(e.TgZ(0,"mat-header-cell",39)(1,"span",40),e._uU(2,"Descripci\xf3n"),e.qZA()())}function he(t,a){if(1&t&&(e.TgZ(0,"mat-cell",39)(1,"span",41),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.description)}}function xe(t,a){1&t&&(e.TgZ(0,"mat-header-cell",42)(1,"span",40),e._uU(2,"Egresos"),e.qZA()())}function Ce(t,a){if(1&t&&(e.TgZ(0,"mat-cell",42)(1,"span",43),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.amount,"","es")," R$")}}function Ze(t,a){1&t&&e._UZ(0,"mat-header-row",48)}function ye(t,a){1&t&&e._UZ(0,"mat-row",49)}function be(t,a){if(1&t&&(e.TgZ(0,"div"),e._UZ(1,"hr"),e.TgZ(2,"div",7)(3,"div",11)(4,"p",33)(5,"b"),e._uU(6,"Caja anterior"),e.qZA(),e._UZ(7,"br"),e._uU(8),e.ALo(9,"number"),e.qZA()(),e.TgZ(10,"div",11)(11,"p",33)(12,"b"),e._uU(13,"Caja total"),e.qZA(),e._UZ(14,"br"),e._uU(15),e.ALo(16,"number"),e.qZA()()()()),2&t){const n=e.oxw();e.xp6(8),e.hij(" ",e.Dn7(9,2,n.beforeAmount||0,"","es")," R$ "),e.xp6(7),e.hij(" ",e.Dn7(16,6,n.todayAmount||0,"","es")," R$ ")}}function Te(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"li",57)(1,"div",7)(2,"div",58)(3,"p"),e._uU(4),e.qZA()(),e.TgZ(5,"div",59)(6,"p",33)(7,"button",60),e.NdJ("click",function(){const d=e.CHM(n).$implicit,v=e.oxw(2);return e.KtG(v.deleteComment(d.id))}),e._UZ(8,"span",61),e.qZA()()()()()}if(2&t){const n=a.$implicit;e.xp6(4),e.Oqu(n.comment)}}function Ae(t,a){1&t&&(e.TgZ(0,"div",31),e._UZ(1,"hr"),e.TgZ(2,"label",62),e._uU(3,"Agregar nuevo comentario"),e.qZA(),e._UZ(4,"textarea",63),e.qZA())}function Ue(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"button",64),e.NdJ("click",function(){e.CHM(n);const p=e.oxw(2);return e.KtG(p.blockDailyResume())}),e.TgZ(1,"span"),e._uU(2,"Bloquear"),e.qZA()()}}function De(t,a){1&t&&(e.TgZ(0,"button",65)(1,"span"),e._uU(2,"Bloqueado"),e.qZA()())}function we(t,a){if(1&t&&(e.TgZ(0,"div")(1,"h6"),e._uU(2,"Comentarios"),e.qZA(),e.TgZ(3,"div",7)(4,"div",50)(5,"ul",51),e.YNc(6,Te,9,1,"li",52),e.qZA()()(),e.YNc(7,Ae,5,0,"div",53),e.TgZ(8,"div",54),e.YNc(9,Ue,3,0,"button",55),e.YNc(10,De,3,0,"button",56),e.qZA()()),2&t){const n=e.oxw();e.xp6(6),e.Q6J("ngForOf",n.commentsFromWeek),e.xp6(1),e.Q6J("ngIf",!n.closed),e.xp6(2),e.Q6J("ngIf",!n.closed),e.xp6(1),e.Q6J("ngIf",n.closed)}}T.extend(ne),T.extend(ae),T.extend(oe),T.tz.setDefault("America/Manaus");let Fe=(()=>{class t{constructor(n,i,p,d,v,g){var r=this;this.ngxUiLoaderService=n,this.movementsService=i,this.dataService=p,this.formBuilder=d,this.titleService=v,this.router=g,this.today=T.tz().format("DD/MM/YYYY"),this.regularContractsFromToday=0,this.amountContractsFromToday=0,this.paymentsToBeCollected=0,this.amountToBeCollected=0,this.contractsFromToday=0,this.movementsCollected=0,this.amountCollected=0,this.expensesAmount=0,this.incomesAmount=0,this.beforeAmount=0,this.todayAmount=0,this.total=0,this.workers=[],this.commentsFromWeek=[],this.movementsFromToday=[],this.closed=!1,this.isAdmin=!1,this.displayedColumns=["details","amount"],this.displayedColumnsWithImage=["details","amount","image"],this.redirect=(l="")=>{this.router.navigate(""!==l?[`${l}`]:[y.f.routes.dash])},this.loadData=(0,h.Z)(function*(l=!1){r.ngxUiLoaderService.startLoader("loader-02");try{const o=r.elementForm.get(["worker"]),s=yield r.movementsService.dailyResume(o?.value);if(s){const{regularContractsFromToday:_,amountContractsFromToday:f,paymentsToBeCollected:A,amountToBeCollected:b,contractsFromToday:Y,movementsFromToday:q,movementsCollected:_t,amountCollected:B,expensesAmount:P,incomesAmount:J,beforeAmount:ft,todayAmount:gt,comments:vt,workers:ht,closed:xt}=s;l||(r.workers=ht),r.amountContractsFromToday=f,r.amountToBeCollected=b,r.amountCollected=B,r.expensesAmount=P,r.incomesAmount=J,r.beforeAmount=ft,r.todayAmount=gt,r.regularContractsFromToday=_,r.paymentsToBeCollected=A,r.contractsFromToday=Y,r.movementsCollected=_t,r.commentsFromWeek=vt,r.closed=xt,r.total=B-f+(J-P),r.incomesDataSource=new c.by(q.incomesMovementsFromToday),r.expensesDataSource=new c.by(q.expensesMovementsFromToday)}}catch(o){r.dataService.errorHandling(o)}finally{r.ngxUiLoaderService.stopLoader("loader-02")}}),this.createForm=()=>{let l="";return this.user&&(l=this.isAdmin?"general":this.user.id),this.formBuilder.group({comment:["",m.kI.required],worker:[l,m.kI.required]})},this.createFinalMovement=(0,h.Z)(function*(){r.ngxUiLoaderService.startLoader("loader-02");try{const{comment:l,worker:o}=r.elementForm.getRawValue();yield r.movementsService.createMovement({amount:r.todayAmount,type:"final",description:"Cierre de caja",paymentPicture:"",comment:l,createdBy:o}),r.redirect(y.f.routes.dash)}catch(l){r.dataService.errorHandling(l)}finally{r.ngxUiLoaderService.stopLoader("loader-02")}}),this.blockDailyResume=(0,h.Z)(function*(){Z().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Bloquear",cancelButtonText:"Cancelar"}).then(l=>{l.isConfirmed&&r.createFinalMovement()})}),this.openImage=l=>{Z().fire({title:"<strong>Imagen</strong>",html:`<div class="card"><div class="card-body"><img src="${l}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Cerrar",confirmButtonAriaLabel:"close"})},this.changeWorker=function(){var l=(0,h.Z)(function*(o){o.preventDefault(),o&&(r.elementForm.patchValue({worker:o.target.value}),r.loadData(!0))});return function(o){return l.apply(this,arguments)}}(),this.deleteComment=function(){var l=(0,h.Z)(function*(o){r.ngxUiLoaderService.startLoader("loader-02");try{yield r.movementsService.deleteComment(o),r.loadData(!0)}catch(s){r.dataService.errorHandling(s)}finally{r.ngxUiLoaderService.stopLoader("loader-02")}});return function(o){return l.apply(this,arguments)}}(),this.user=this.dataService.getLoggedUser(),(!this.dataService.getIsLoggedIn()||!this.user)&&(this.dataService.clearLoginData(),this.redirect(y.f.routes.login)),this.user&&(this.isAdmin=["Rt","Adm"].includes(this.user.permission))}ngOnInit(){(0,x.qS)(S.Z),this.titleService.setTitle("IMPERIAL | Resumen del d\xeda"),this.elementForm=this.createForm(),this.loadData()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(U.LA),e.Y36(D.M),e.Y36(w.D),e.Y36(m.qu),e.Y36(F.Dx),e.Y36(C.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-daily-resume"]],decls:147,vars:63,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],["name","elementForm","novalidate","",3,"formGroup"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"col-6",2,"padding","0 !important"],[2,"text-align","left"],[1,"card-title"],[2,"text-align","right"],[4,"ngIf"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","details"],["fxFlex","auto 1 200px",4,"matHeaderCellDef"],["fxFlex","auto 1 200px",4,"matCellDef"],["matColumnDef","amount"],["fxFlex","auto 1",4,"matHeaderCellDef"],["fxFlex","auto 1",4,"matCellDef"],["matColumnDef","image"],["fxFlex","auto 1 100px",4,"matHeaderCellDef"],["fxFlex","auto 1 100px",4,"matCellDef"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",4,"matRowDef","matRowDefColumns"],[1,"mb-3"],[1,"col-6",2,"padding","0 12px !important"],[2,"text-align","center"],["for","worker",1,"form-label"],["id","worker","formControlName","worker","required","",1,"form-select",3,"change"],["value","general"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["fxFlex","auto 1 200px"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","width","100%"],["fxFlex","auto 1"],[2,"margin","0","text-align","right","width","100%"],["fxFlex","auto 1 100px"],["style","margin: 0; text-align: center; width: 100%;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"feather","icon-image"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user"],[1,"d-grid","gap-2"],[1,"list-group","list-group-flush"],["class","list-group-item",4,"ngFor","ngForOf"],["class","mb-3",4,"ngIf"],[1,"row","p-2","mt-4"],["class","btn btn-primary","type","button",3,"click",4,"ngIf"],["class","btn btn-primary","type","button","disabled","",4,"ngIf"],[1,"list-group-item"],[1,"col-10",2,"padding","0 !important"],[1,"col-2",2,"padding","0 !important"],["type","button",1,"btn","btn-red","btn-icon",3,"click"],[1,"feather","icon-x"],["for","comment",1,"form-label"],["id","comment","formControlName","comment","autocomplete","off","required","",1,"form-control"],["type","button",1,"btn","btn-primary",3,"click"],["type","button","disabled","",1,"btn","btn-primary"]],template:function(n,i){1&n&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimientos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Resumen del d\xeda"),e.qZA()()(),e.TgZ(9,"form",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",7)(15,"div",11)(16,"p",12)(17,"b",13),e._uU(18,"Resumen del d\xeda"),e.qZA()()(),e.TgZ(19,"div",11)(20,"p",14)(21,"b",13),e._uU(22),e.qZA()()()(),e.YNc(23,re,9,1,"div",15),e._UZ(24,"hr"),e.TgZ(25,"div",16)(26,"div",17)(27,"mat-table",18,19),e.ynx(29,20),e.YNc(30,le,3,0,"mat-header-cell",21),e.YNc(31,me,3,1,"mat-cell",22),e.BQk(),e.ynx(32,23),e.YNc(33,ce,3,0,"mat-header-cell",24),e.YNc(34,se,4,5,"mat-cell",25),e.BQk(),e.ynx(35,26),e.YNc(36,de,3,0,"mat-header-cell",27),e.YNc(37,_e,3,2,"mat-cell",28),e.BQk(),e.YNc(38,fe,1,0,"mat-header-row",29),e.YNc(39,ge,1,0,"mat-row",30),e.qZA()()(),e._UZ(40,"br"),e.TgZ(41,"div",16)(42,"div",17)(43,"mat-table",18,19),e.ynx(45,20),e.YNc(46,ve,3,0,"mat-header-cell",21),e.YNc(47,he,3,1,"mat-cell",22),e.BQk(),e.ynx(48,23),e.YNc(49,xe,3,0,"mat-header-cell",24),e.YNc(50,Ce,4,5,"mat-cell",25),e.BQk(),e.YNc(51,Ze,1,0,"mat-header-row",29),e.YNc(52,ye,1,0,"mat-row",30),e.qZA()()(),e._UZ(53,"br"),e.TgZ(54,"div",31)(55,"div",8)(56,"div",9)(57,"div",10)(58,"div",7)(59,"div",11)(60,"p",12)(61,"b"),e._uU(62,"Monto a cobrar en el d\xeda"),e.qZA()()(),e.TgZ(63,"div",11)(64,"p",14),e._uU(65),e.ALo(66,"number"),e.qZA()()(),e._UZ(67,"br"),e.TgZ(68,"div",7)(69,"div",11)(70,"p",12)(71,"b"),e._uU(72,"Abonos"),e.qZA()()(),e.TgZ(73,"div",11)(74,"p",14),e._uU(75),e.ALo(76,"number"),e.qZA()()(),e.TgZ(77,"div",7)(78,"div",11)(79,"p",12)(80,"b"),e._uU(81,"Ventas"),e.qZA()()(),e.TgZ(82,"div",11)(83,"p",14),e._uU(84),e.ALo(85,"number"),e.qZA()()(),e.TgZ(86,"div",7)(87,"div",11)(88,"p",12)(89,"b"),e._uU(90,"Ingresos"),e.qZA()()(),e.TgZ(91,"div",11)(92,"p",14),e._uU(93),e.ALo(94,"number"),e.qZA()()(),e.TgZ(95,"div",7)(96,"div",11)(97,"p",12)(98,"b"),e._uU(99,"Egresos"),e.qZA()()(),e.TgZ(100,"div",11)(101,"p",14),e._uU(102),e.ALo(103,"number"),e.qZA()()(),e._UZ(104,"hr"),e.TgZ(105,"div",7)(106,"div",11)(107,"p",12)(108,"b"),e._uU(109,"SALDO DEL D\xcdA"),e.qZA()()(),e.TgZ(110,"div",11)(111,"p",14),e._uU(112),e.ALo(113,"number"),e.qZA()()(),e.YNc(114,be,17,10,"div",15),e._UZ(115,"hr"),e.TgZ(116,"div",7)(117,"div",32)(118,"p",33)(119,"b"),e._uU(120,"Contratos a cobrar"),e.qZA(),e._UZ(121,"br"),e._uU(122),e.ALo(123,"number"),e.qZA()(),e.TgZ(124,"div",32)(125,"p",33)(126,"b"),e._uU(127,"Contratos abonados"),e.qZA(),e._UZ(128,"br"),e._uU(129),e.ALo(130,"number"),e.qZA()(),e.TgZ(131,"div",32)(132,"p",33)(133,"b"),e._uU(134,"Contratos nuevos"),e.qZA(),e._UZ(135,"br"),e._uU(136),e.ALo(137,"number"),e.qZA()(),e.TgZ(138,"div",32)(139,"p",33)(140,"b"),e._uU(141,"Contratos normales"),e.qZA(),e._UZ(142,"br"),e._uU(143),e.ALo(144,"number"),e.qZA()()()()()()()()()()(),e._UZ(145,"hr"),e.YNc(146,we,11,4,"div",15),e.qZA()),2&n&&(e.xp6(9),e.Q6J("formGroup",i.elementForm),e.xp6(13),e.Oqu(i.today),e.xp6(1),e.Q6J("ngIf",i.isAdmin),e.xp6(4),e.Q6J("dataSource",i.incomesDataSource),e.xp6(11),e.Q6J("matHeaderRowDef",i.displayedColumnsWithImage)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumnsWithImage),e.xp6(4),e.Q6J("dataSource",i.expensesDataSource),e.xp6(8),e.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",i.displayedColumns),e.xp6(13),e.hij(" ",e.Dn7(66,23,i.amountToBeCollected||0,"","es")," R$ "),e.xp6(10),e.hij(" ",e.Dn7(76,27,i.amountCollected||0,"","es")," R$ "),e.xp6(9),e.hij(" - ",e.Dn7(85,31,i.amountContractsFromToday||0,"","es")," R$ "),e.xp6(9),e.hij(" ",e.Dn7(94,35,i.incomesAmount||0,"","es")," R$ "),e.xp6(9),e.hij(" - ",e.Dn7(103,39,i.expensesAmount||0,"","es")," R$ "),e.xp6(10),e.hij(" ",e.Dn7(113,43,i.total||0,"","es")," R$ "),e.xp6(2),e.Q6J("ngIf","general"===i.elementForm.getRawValue().worker),e.xp6(8),e.hij(" ",e.Dn7(123,47,i.paymentsToBeCollected||0,"","es")," "),e.xp6(7),e.hij(" ",e.Dn7(130,51,i.movementsCollected||0,"","es")," "),e.xp6(7),e.hij(" ",e.Dn7(137,55,i.contractsFromToday||0,"","es")," "),e.xp6(7),e.hij(" ",e.Dn7(144,59,i.regularContractsFromToday||0,"","es")," "),e.xp6(3),e.Q6J("ngIf",i.isAdmin&&"general"!==i.elementForm.getRawValue().worker))},dependencies:[C.rH,m._Y,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.JL,m.Q7,x.sg,x.O5,R.YE,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,M.yH,m.sg,m.u,x.JJ],styles:[".ngx-datatable[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]{display:none!important}"]}),t})();var k=u(7317),qe=u(6811),Se=u(4074),Re=u(5580);function Me(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",34)(1,"img",35),e.NdJ("click",function(){e.CHM(n);const p=e.oxw();return e.KtG(p.openImage("payment"))}),e.qZA()()}if(2&t){const n=e.oxw();e.xp6(1),e.Q6J("src",n.paymentImage,e.LSH)}}class Ye{constructor(a,n){this.src=a,this.file=n}}let Le=(()=>{class t{constructor(n,i,p,d,v,g,r,l){var o=this;this.ngxUiLoaderService=n,this.movementsService=i,this.imagesService=p,this.dataService=d,this.formBuilder=v,this.matDialog=g,this.titleService=r,this.router=l,this.paymentImage=null,this.uploader=new k.bA({allowedMimeType:["image/png","image/jpg","image/jpeg"],maxFileSize:1048576,autoUpload:!1,isHTML5:!0,url:""}),this.createForm=()=>this.formBuilder.group({type:["",m.kI.required],amount:["",m.kI.required],description:["",m.kI.required]}),this.redirect=(s="")=>{this.router.navigate(""!==s?[`${s}`]:[y.f.routes.dash])},this.createPayment=function(){var s=(0,h.Z)(function*(_){o.ngxUiLoaderService.startLoader("loader-02");try{_.preventDefault();let f=null;if(!o.paymentImage)return void o.dataService.errorHandling({front:!0,message:"La imagen del movimiento es obligatoria, verifique e intente nuevamente."});f=yield o.imagesService.createImage({base64:o.paymentImage,type:"payment"});const A=o.elementForm.getRawValue(),{type:b,amount:Y,description:q}=A;yield o.movementsService.createMovement({type:b,amount:Y,description:q,paymentPicture:f?.id||""}),o.redirect(y.f.routes.dash)}catch(f){o.dataService.errorHandling(f)}finally{o.ngxUiLoaderService.stopLoader("loader-02")}});return function(_){return s.apply(this,arguments)}}(),this.openImage=s=>{let _="",f="";"payment"===s&&(_="pago",f=this.paymentImage),Z().fire({title:`<strong>Foto del ${_}</strong>`,html:`<div class="card"><div class="card-body"><img src="${f}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Cerrar",confirmButtonAriaLabel:"close"})},this.openCamera=s=>{this.cameraDialogRef=this.matDialog.open(qe.M,{autoFocus:!0,disableClose:!0,height:"90vh",minWidth:"95vw"}),this.cameraDialogRef.afterClosed().subscribe(function(){var _=(0,h.Z)(function*(f){f&&"payment"===s&&(o.paymentImage=f),o.cameraDialogRef=null});return function(f){return _.apply(this,arguments)}}())},this.uploadFile=s=>{const _=s.files[0],f=new FileReader;f.addEventListener("load",function(){var A=(0,h.Z)(function*(b){o.selectedFile=new Ye(b.target.result,_),o.paymentImage=b.target.result});return function(b){return A.apply(this,arguments)}}()),f.readAsDataURL(_)},this.dataService.clearCreatedUser()}ngOnInit(){this.titleService.setTitle("IMPERIAL | Registrar movimiento"),this.elementForm=this.createForm()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(U.LA),e.Y36(D.M),e.Y36(Se.C),e.Y36(w.D),e.Y36(m.qu),e.Y36(Re.uw),e.Y36(F.Dx),e.Y36(C.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-create"]],decls:52,vars:5,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],["name","elementForm","novalidate","",3,"formGroup"],[1,"mb-3"],["for","type",1,"form-label"],["id","type","formControlName","type","required","",1,"form-select"],["value","in","selected",""],["value","out"],["for","amount",1,"form-label"],[1,"input-group"],["placement","bottom","ngbTooltip","Tooltip on bottom",1,"input-group-text","hover"],["type","text","id","amount","name","amount","appInputRestriction","float","formControlName","amount","oninput","this.value=this.value.replace(/[^0-9]/g,'')","required","",1,"form-control",2,"text-align","right","padding-right","1em"],["for","description",1,"form-label"],["id","description","formControlName","description","autocomplete","off","required","",1,"form-control"],[1,"row","mb-3"],["class","col-12","style","text-align: center",4,"ngIf"],[1,"col-12"],["id","formFile","type","file","accept","image/png,image/jpeg","ng2FileSelect","",1,"form-control",3,"uploader","change"],["fileInput",""],[1,"d-grid","gap-2"],["href","","href","javascript:void(0)",1,"btn","btn-primary",3,"click"],[1,"feather","icon-camera"],[2,"text-align","center"],["type","submit",1,"btn","btn-primary","me-2",3,"disabled","click"],[1,"btn","btn-secondary",3,"routerLink","click"],[1,"col-12",2,"text-align","center"],["alt","...",1,"card-img-top",3,"src","click"]],template:function(n,i){if(1&n){const p=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimientos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Registrar"),e.qZA()()(),e.TgZ(9,"div",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"h6",10),e._uU(14,"Registrar"),e.qZA(),e.TgZ(15,"form",11)(16,"div",12)(17,"label",13),e._uU(18,"Forma"),e.qZA(),e.TgZ(19,"select",14)(20,"option",15),e._uU(21,"Ingreso"),e.qZA(),e.TgZ(22,"option",16),e._uU(23,"Egreso"),e.qZA()()(),e.TgZ(24,"div",12)(25,"label",17),e._uU(26,"Monto"),e.qZA(),e.TgZ(27,"div",18)(28,"span",19),e._uU(29,"R$"),e.qZA(),e._UZ(30,"input",20),e.qZA()(),e.TgZ(31,"div",12)(32,"label",21),e._uU(33,"Descripci\xf3n"),e.qZA(),e._UZ(34,"textarea",22),e.qZA(),e.TgZ(35,"div",23),e.YNc(36,Me,2,1,"div",24),e.qZA(),e.TgZ(37,"div",23)(38,"div",25)(39,"input",26,27),e.NdJ("change",function(){e.CHM(p);const v=e.MAs(40);return e.KtG(i.uploadFile(v))}),e.qZA()()(),e.TgZ(41,"div",23)(42,"div",25)(43,"div",28)(44,"a",29),e.NdJ("click",function(){return i.openCamera("payment")}),e._UZ(45,"span",30),e.qZA()()()(),e._UZ(46,"hr"),e.TgZ(47,"div",31)(48,"button",32),e.NdJ("click",function(v){return i.createPayment(v)}),e._uU(49,"Aceptar"),e.qZA(),e.TgZ(50,"button",33),e.NdJ("click",function(){return!1}),e._uU(51,"Cancelar"),e.qZA()()()()()()()}2&n&&(e.xp6(15),e.Q6J("formGroup",i.elementForm),e.xp6(21),e.Q6J("ngIf",i.paymentImage),e.xp6(3),e.Q6J("uploader",i.uploader),e.xp6(9),e.Q6J("disabled",i.elementForm.invalid),e.xp6(2),e.Q6J("routerLink","/admin/dashboard"))},dependencies:[C.rH,m._Y,m.YN,m.Kr,m.Fj,m.EJ,m.JJ,m.JL,m.Q7,x.O5,k.C6,N._L,m.sg,m.u]}),t})();var I=u(2417),Ne=u(8405);function ke(t,a){1&t&&(e.TgZ(0,"div",11)(1,"span",24)(2,"h6",25),e._uU(3,"Seleccione un tipo de movimiento"),e.qZA()()())}function Ie(t,a){1&t&&(e.TgZ(0,"mat-header-cell",41)(1,"span",42),e._uU(2,"Creado por"),e.qZA()())}function Be(t,a){if(1&t&&(e.TgZ(0,"mat-cell",41)(1,"span",43),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.createdBy.getFullName())}}function Pe(t,a){1&t&&(e.TgZ(0,"mat-header-cell",41)(1,"span",42),e._uU(2,"Cliente"),e.qZA()())}function Je(t,a){if(1&t&&(e.TgZ(0,"mat-cell",41)(1,"span",43),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.client.getFullName())}}function Qe(t,a){1&t&&(e.TgZ(0,"mat-header-cell",44)(1,"span",42),e._uU(2,"Monto prestado"),e.qZA()())}function He(t,a){if(1&t&&(e.TgZ(0,"mat-cell",44)(1,"span",45),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.loanAmount,"","es")," R$")}}function $e(t,a){1&t&&(e.TgZ(0,"mat-header-cell",44)(1,"span",42),e._uU(2,"Pagos"),e.qZA()())}function Ee(t,a){if(1&t&&(e.TgZ(0,"mat-cell",44)(1,"span",42),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(e.Dn7(3,1,n.payments,"","es"))}}function Ve(t,a){1&t&&(e.TgZ(0,"mat-header-cell",46)(1,"span",42),e._uU(2,"Anular"),e.qZA()())}function je(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"mat-cell",46)(1,"span",42)(2,"button",47),e.NdJ("click",function(){const d=e.CHM(n).$implicit,v=e.oxw(2);return e.KtG(v.cancelMovement(d,!0))}),e._UZ(3,"span",48),e.qZA()()()}}function Oe(t,a){1&t&&e._UZ(0,"mat-header-row",49)}function Ge(t,a){1&t&&e._UZ(0,"mat-row",50)}function Ke(t,a){if(1&t&&(e.TgZ(0,"mat-table",26,27),e.ynx(2,28),e.YNc(3,Ie,3,0,"mat-header-cell",29),e.YNc(4,Be,3,1,"mat-cell",30),e.BQk(),e.ynx(5,31),e.YNc(6,Pe,3,0,"mat-header-cell",29),e.YNc(7,Je,3,1,"mat-cell",30),e.BQk(),e.ynx(8,32),e.YNc(9,Qe,3,0,"mat-header-cell",33),e.YNc(10,He,4,5,"mat-cell",34),e.BQk(),e.ynx(11,35),e.YNc(12,$e,3,0,"mat-header-cell",33),e.YNc(13,Ee,4,5,"mat-cell",34),e.BQk(),e.ynx(14,36),e.YNc(15,Ve,3,0,"mat-header-cell",37),e.YNc(16,je,4,0,"mat-cell",38),e.BQk(),e.YNc(17,Oe,1,0,"mat-header-row",39),e.YNc(18,Ge,1,0,"mat-row",40),e.qZA()),2&t){const n=e.oxw();e.Q6J("dataSource",n.dataSource),e.xp6(17),e.Q6J("matHeaderRowDef",n.contractColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",n.contractColumns)}}function We(t,a){1&t&&(e.TgZ(0,"mat-header-cell",41)(1,"span",42),e._uU(2,"Descripci\xf3n"),e.qZA()())}function ze(t,a){if(1&t&&(e.TgZ(0,"mat-cell",41)(1,"span",43),e._uU(2),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.description)}}function Xe(t,a){1&t&&(e.TgZ(0,"mat-header-cell",44)(1,"span",42),e._uU(2,"Ingresos"),e.qZA()())}function et(t,a){if(1&t&&(e.TgZ(0,"mat-cell",44)(1,"span",45),e._uU(2),e.ALo(3,"number"),e.qZA()()),2&t){const n=a.$implicit;e.xp6(2),e.hij("",e.Dn7(3,1,n.amount,"","es")," R$")}}function tt(t,a){1&t&&(e.TgZ(0,"mat-header-cell",46)(1,"span",42),e._uU(2,"Imagen"),e.qZA()())}function nt(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"span",42)(1,"button",55),e.NdJ("click",function(){e.CHM(n);const p=e.oxw().$implicit,d=e.oxw(2);return e.KtG(d.openImage(p.paymentPicture))}),e._UZ(2,"span",56),e.qZA()()}}function at(t,a){1&t&&e._UZ(0,"span",42)}function ot(t,a){if(1&t&&(e.TgZ(0,"mat-cell",46),e.YNc(1,nt,3,0,"span",54),e.YNc(2,at,1,0,"span",54),e.qZA()),2&t){const n=a.$implicit;e.xp6(1),e.Q6J("ngIf",n.paymentPicture),e.xp6(1),e.Q6J("ngIf",!n.paymentPicture)}}function it(t,a){1&t&&(e.TgZ(0,"mat-header-cell",46)(1,"span",42),e._uU(2,"Anular"),e.qZA()())}function rt(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"mat-cell",46)(1,"span",42)(2,"button",47),e.NdJ("click",function(){const d=e.CHM(n).$implicit,v=e.oxw(2);return e.KtG(v.cancelMovement(d))}),e._UZ(3,"span",48),e.qZA()()()}}function lt(t,a){1&t&&e._UZ(0,"mat-header-row",49)}function mt(t,a){1&t&&e._UZ(0,"mat-row",50)}function ct(t,a){if(1&t&&(e.TgZ(0,"mat-table",26,27),e.ynx(2,51),e.YNc(3,We,3,0,"mat-header-cell",29),e.YNc(4,ze,3,1,"mat-cell",30),e.BQk(),e.ynx(5,52),e.YNc(6,Xe,3,0,"mat-header-cell",33),e.YNc(7,et,4,5,"mat-cell",34),e.BQk(),e.ynx(8,53),e.YNc(9,tt,3,0,"mat-header-cell",37),e.YNc(10,ot,3,2,"mat-cell",38),e.BQk(),e.ynx(11,36),e.YNc(12,it,3,0,"mat-header-cell",37),e.YNc(13,rt,4,0,"mat-cell",38),e.BQk(),e.YNc(14,lt,1,0,"mat-header-row",39),e.YNc(15,mt,1,0,"mat-row",40),e.qZA()),2&t){const n=e.oxw();e.Q6J("dataSource",n.dataSource),e.xp6(14),e.Q6J("matHeaderRowDef",n.movementColumns)("matHeaderRowDefSticky","true"),e.xp6(1),e.Q6J("matRowDefColumns",n.movementColumns)}}let st=(()=>{class t{constructor(n,i,p,d,v,g,r){var l=this;this.ngxUiLoaderService=n,this.movementsService=i,this.contractsService=p,this.dataService=d,this.formBuilder=v,this.titleService=g,this.router=r,this.movementColumns=["details","amount","image","options"],this.contractColumns=["createdBy","client","loanAmount","payments","options"],this.createForm=()=>this.formBuilder.group({type:[null,m.kI.required]}),this.redirect=(o="")=>{this.router.navigate(""!==o?[`${o}`]:[y.f.routes.dash])},this.loadData=(0,h.Z)(function*(){l.ngxUiLoaderService.startLoader("loader-02"),l.dataSource=new c.by;try{let o;const{type:s}=l.elementForm.getRawValue();"contract"===s?(o=yield l.contractsService.contractsFromToday(),o.data=o.data.map(_=>(_.createdBy=new I.T(_.createdBy),_.client=new I.T(_.client),_))):o=yield l.movementsService.movementsFromToday(s),o&&(l.dataSource=new c.by(o.data))}catch(o){l.dataService.errorHandling(o)}finally{l.ngxUiLoaderService.stopLoader("loader-02")}}),this.sendPayment=function(){var o=(0,h.Z)(function*(s,_=!1){try{l.ngxUiLoaderService.startLoader("loader-02"),_?yield l.contractsService.cancelContract(s.id):yield l.movementsService.cancelMovement(s.id),l.loadData()}catch(f){l.dataService.errorHandling(f)}finally{l.ngxUiLoaderService.stopLoader("loader-02")}});return function(s){return o.apply(this,arguments)}}(),this.changeType=o=>{o.preventDefault(),o&&(this.elementForm.patchValue({type:o.target.value}),this.loadData())},this.cancelMovement=function(){var o=(0,h.Z)(function*(s,_=!1){Z().fire({title:"\xbfEst\xe1s seguro?",text:"Esta acci\xf3n no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Anular",cancelButtonText:"Cancelar"}).then(f=>{f.isConfirmed&&l.sendPayment(s,_)})});return function(s){return o.apply(this,arguments)}}(),this.openImage=o=>{Z().fire({title:"<strong>Imagen</strong>",html:`<div class="card"><div class="card-body"><img src="${o}" class="card-img-top" alt="..."></div></div>`,showCloseButton:!0,showCancelButton:!1,confirmButtonText:"Cerrar",confirmButtonAriaLabel:"close"})},this.dataService.clearCreatedUser()}ngOnInit(){(0,x.qS)(S.Z),this.titleService.setTitle("IMPERIAL | Registrar movimiento"),this.elementForm=this.createForm()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(U.LA),e.Y36(D.M),e.Y36(Ne.W),e.Y36(w.D),e.Y36(m.qu),e.Y36(F.Dx),e.Y36(C.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-cancel"]],decls:35,vars:5,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/admin/dashboard"],[1,"feather","icon-home"],["aria-current","page",1,"breadcrumb-item","active"],["name","elementForm","novalidate","",3,"formGroup"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card","card-table"],[1,"card-body"],[1,"mb-3"],["for","type",1,"form-label"],["id","type","formControlName","type","required","",1,"form-select",3,"change"],["value","payment"],["value","contract"],["value","expense"],["value","income"],["class","mb-3",4,"ngIf"],[2,"overflow-x","auto !important"],[1,"table-responsive"],["class","common-table","matSort","",3,"dataSource",4,"ngIf"],[2,"text-align","center"],[1,"btn","btn-secondary",3,"routerLink","click"],[2,"text-align","center","width","100%"],[1,"card-title"],["matSort","",1,"common-table",3,"dataSource"],["table",""],["matColumnDef","createdBy"],["fxFlex","auto 1 200px",4,"matHeaderCellDef"],["fxFlex","auto 1 200px",4,"matCellDef"],["matColumnDef","client"],["matColumnDef","loanAmount"],["fxFlex","auto 1",4,"matHeaderCellDef"],["fxFlex","auto 1",4,"matCellDef"],["matColumnDef","payments"],["matColumnDef","options"],["fxFlex","auto 1 100px",4,"matHeaderCellDef"],["fxFlex","auto 1 100px",4,"matCellDef"],["class","grey-400-bg font-weight-600",4,"matHeaderRowDef","matHeaderRowDefSticky"],["class","user","matRipple","",4,"matRowDef","matRowDefColumns"],["fxFlex","auto 1 200px"],[2,"margin","0","text-align","center","width","100%"],[2,"margin","0","text-align","left","width","100%"],["fxFlex","auto 1"],[2,"margin","0","text-align","right","width","100%"],["fxFlex","auto 1 100px"],["type","button",1,"btn","btn-red","btn-icon",3,"click"],[1,"feather","icon-trash"],[1,"grey-400-bg","font-weight-600"],["matRipple","",1,"user"],["matColumnDef","details"],["matColumnDef","amount"],["matColumnDef","image"],["style","margin: 0; text-align: center; width: 100%;",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"feather","icon-image"]],template:function(n,i){1&n&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._UZ(4,"span",4),e.qZA()(),e.TgZ(5,"li",2),e._uU(6,"Movimientos"),e.qZA(),e.TgZ(7,"li",5),e._uU(8,"Anular"),e.qZA()()(),e.TgZ(9,"form",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11)(15,"label",12),e._uU(16,"Tipo de movimiento"),e.qZA(),e.TgZ(17,"select",13),e.NdJ("change",function(d){return i.changeType(d)}),e.TgZ(18,"option",14),e._uU(19,"Abono"),e.qZA(),e.TgZ(20,"option",15),e._uU(21,"Contrato"),e.qZA(),e.TgZ(22,"option",16),e._uU(23,"Egreso"),e.qZA(),e.TgZ(24,"option",17),e._uU(25,"Ingreso"),e.qZA()()(),e.YNc(26,ke,4,0,"div",18),e.TgZ(27,"div",19)(28,"div",20),e.YNc(29,Ke,19,4,"mat-table",21),e.YNc(30,ct,16,4,"mat-table",21),e.qZA()(),e._UZ(31,"hr"),e.TgZ(32,"div",22)(33,"button",23),e.NdJ("click",function(){return!1}),e._uU(34,"Cerrar"),e.qZA()()()()()()()),2&n&&(e.xp6(9),e.Q6J("formGroup",i.elementForm),e.xp6(17),e.Q6J("ngIf",!i.elementForm.getRawValue().type),e.xp6(3),e.Q6J("ngIf","contract"===i.elementForm.getRawValue().type),e.xp6(1),e.Q6J("ngIf",i.elementForm.getRawValue().type&&"contract"!==i.elementForm.getRawValue().type),e.xp6(3),e.Q6J("routerLink","/admin/dashboard"))},dependencies:[C.rH,m._Y,m.YN,m.Kr,m.EJ,m.JJ,m.JL,m.Q7,x.O5,R.YE,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,M.yH,m.sg,m.u,x.JJ]}),t})();var dt=u(6356);const ut=[{path:"",redirectTo:"create",pathMatch:"full"},{path:"create",component:Le},{path:"daily-resume",component:Fe},{path:"validation-payments-pending",component:te},{path:"cancel-movement",component:st}];let pt=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[C.Bz.forChild(ut),m.u5,dt.A,m.UX]}),t})()}}]);